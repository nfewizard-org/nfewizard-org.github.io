{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":"<p>Reposit\u00f3rio do projeto nfewizard.</p>"},{"location":"#sobre","title":"Sobre","text":"<p>NFeWizard-io \u00e9 uma biblioteca Node.js projetada para simplificar a intera\u00e7\u00e3o com os webservices da SEFAZ, proporcionando uma solu\u00e7\u00e3o robusta para automa\u00e7\u00e3o de processos relacionados \u00e0 Nota Fiscal Eletr\u00f4nica (NF-e). A biblioteca oferece m\u00e9todos abrangentes para diversas opera\u00e7\u00f5es fiscais, incluindo:</p> <ul> <li>Autoriza\u00e7\u00e3o (Emiss\u00e3o de NFe): Submiss\u00e3o de notas fiscais eletr\u00f4nicas para autoriza\u00e7\u00e3o.</li> <li>Distribui\u00e7\u00e3o DFe: Consulta e Download de DF-e (Documentos fiscais eletr\u00f4nicos), facilitando o acesso a documentos fiscais eletr\u00f4nicos.</li> <li>Consulta de Protocolo: Verifica\u00e7\u00e3o da situa\u00e7\u00e3o atual da NF-e na Base de Dados do Portal da Secretaria de Fazenda Estadual.</li> <li>Inutiliza\u00e7\u00e3o de NFe: Processo de inutiliza\u00e7\u00e3o de n\u00fameros de NF-e que n\u00e3o ser\u00e3o utilizados, assegurando a conformidade fiscal.</li> <li>Consulta de Status do Servi\u00e7o: Monitoramento do status dos servi\u00e7os da SEFAZ, garantindo a disponibilidade dos webservices.</li> <li>Recep\u00e7\u00e3o de Eventos: Tratamento de diversos eventos relacionados \u00e0 NFe, incluindo:<ul> <li>Cancelamento de NFe</li> <li>Carta de Corre\u00e7\u00e3o</li> <li>Ci\u00eancia da Opera\u00e7\u00e3o</li> <li>Confirma\u00e7\u00e3o da Opera\u00e7\u00e3o</li> <li>Desconhecimento da Opera\u00e7\u00e3o</li> <li>EPEC (Evento Pr\u00e9vio de Emiss\u00e3o em Conting\u00eancia)</li> <li>Opera\u00e7\u00e3o N\u00e3o Realizada</li> </ul> </li> <li>Gera\u00e7\u00e3o de DANFE: Cria\u00e7\u00e3o do Documento Auxiliar da Nota Fiscal Eletr\u00f4nica (DANFE), um resumo impresso da NFe.</li> </ul>"},{"location":"#exemplo-de-utilizacao","title":"Exemplo de Utiliza\u00e7\u00e3o","text":"<pre><code>// Instanciar\nconst nfewizard = new NFeWizard();\n\n// Inicializar\nawait nfewizard.NFE_LoadEnvironment({\n    config: {\n        dfe: {\n            baixarXMLDistribuicao: true,\n            pathXMLDistribuicao: \"tmp/DistribuicaoDFe\",\n            armazenarXMLAutorizacao: true,\n            pathXMLAutorizacao: \"tmp/Autorizacao\",\n            armazenarXMLRetorno: true,\n            pathXMLRetorno: \"tmp/RequestLogs\",\n            armazenarXMLConsulta: true,\n            pathXMLConsulta: \"tmp/RequestLogs\",\n            armazenarXMLConsultaComTagSoap: false,\n            armazenarRetornoEmJSON: true,\n            pathRetornoEmJSON: \"tmp/DistribuicaoDFe\",\n\n            pathCertificado: \"certificado.pfx\",\n            senhaCertificado: \"123456\",\n            UF: \"SP\",\n            CPFCNPJ: \"99999999999999\",\n        },\n        nfe: {\n            ambiente: 2,\n            versaoDF: \"4.00\",\n        },\n        email: {\n            host: 'smtp.example.com',\n            port: 587,\n            secure: false,\n            auth: {\n                user: 'seu-email@example.com',\n                pass: 'sua-senha'\n            },\n            emailParams: {\n                from: '\"Seu Nome\" &lt;seu-email@example.com&gt;',\n                to: 'destinatario@example.com',\n                subject: 'Assunto do E-mail',\n            }\n        },\n        lib: {\n            connection: {\n                timeout: 30000,\n            },\n        }\n    }\n});\n\n// Exemplo de Utiliza\u00e7\u00e3o\nconst chaveNFe: DFePorChaveNFe = {\n    cUFAutor: 35,\n    CNPJ: '99999999999999',\n    consChNFe: {\n        chNFe: '00000000000000000000000000000000000000000000'\n    },\n}\n\nawait nfewizard.NFE_DistribuicaoDFePorChave(chaveNFe);\n</code></pre>"},{"location":"#observacoes","title":"Observa\u00e7\u00f5es","text":"<p>Observa\u00e7\u00f5es</p> <p><code>Certificado</code>: Implementado apenas em certificados A1. <code>NodeJs</code>: Testado com vers\u00f5es 16 ou superiores. <code>UF</code>: Testado apenas para S\u00e3o Paulo. Por favor, abra uma issue caso encontre problemas com outros estados.</p>"},{"location":"#contribua-para-nossa-biblioteca-open-source","title":"Contribua para Nossa Biblioteca Open Source","text":"<p>Primeiramente, obrigado por considerar contribuir para nossa biblioteca! Nosso projeto \u00e9 de c\u00f3digo aberto e gratuito para uso, mas manter e desenvolver novas funcionalidades requer tempo e esfor\u00e7o. Se voc\u00ea achar nosso trabalho \u00fatil e quiser apoiar nosso desenvolvimento, considere fazer uma doa\u00e7\u00e3o.</p>"},{"location":"#por-que-doar","title":"Por que doar?","text":"<ul> <li>Suporte Cont\u00ednuo: Sua doa\u00e7\u00e3o ajuda a manter o projeto ativo e em constante evolu\u00e7\u00e3o.</li> <li>Novos Recursos: Com seu apoio, podemos adicionar novos recursos e melhorias.</li> <li>Manuten\u00e7\u00e3o e Corre\u00e7\u00f5es: Garantimos que bugs sejam corrigidos rapidamente e que o c\u00f3digo esteja sempre atualizado.</li> <li>Reconhecimento: Apoiadores s\u00e3o reconhecidos em nossa documenta\u00e7\u00e3o e p\u00e1gina do projeto.</li> <li>Fraldas: Meu primeiro filho nasceu no inicio desse ano, fraldas s\u00e3o caras! \ud83c\udf7c\ud83d\udebc</li> </ul>"},{"location":"#como-doar","title":"Como doar?","text":"<p>Voc\u00ea pode contribuir atrav\u00e9s das seguintes plataformas:</p> <ul> <li>GitHub Sponsors</li> <li> <p>Pix: Se preferir doar via Pix, utilize a seguinte chave:</p> <pre><code>Chave Pix: 944ce2f2-e90f-400a-a388-bb1fe6719e02\nNome: Marco Lima\n</code></pre> </li> </ul> <p>Agradecemos imensamente seu apoio!</p>"},{"location":"#outras-formas-de-contribuir","title":"Outras formas de contribuir","text":"<p>Se voc\u00ea n\u00e3o puder doar financeiramente, existem outras maneiras valiosas de contribuir:</p> <ul> <li>Reportar Bugs: Envie relat\u00f3rios de bugs e problemas que encontrar.</li> <li>Submeter PRs: Contribua com c\u00f3digo, documenta\u00e7\u00e3o ou testes.</li> <li>Espalhe a Palavra: Compartilhe nosso projeto com amigos e colegas.</li> </ul>"},{"location":"#agradecimentos","title":"Agradecimentos","text":"<p>Agradecemos imensamente seu apoio e contribui\u00e7\u00e3o. Juntos, podemos construir e manter uma ferramenta incr\u00edvel para todos!</p> <p>Muito obrigado!</p>"},{"location":"#devs","title":"Devs","text":"Marco Lima"},{"location":"configuracaoDeAmbiente/","title":"Configura\u00e7\u00e3o de Ambiente","text":"<p>Reposit\u00f3rio do projeto nfewizard.</p>"},{"location":"configuracaoDeAmbiente/#dfe","title":"DFE","text":"Chave Descri\u00e7\u00e3o Required <code>baixarXMLDistribuicao</code> Define se os XMLs retornados pelo m\u00e9todo NFeDistribuicaoDFe ser\u00e3o salvos. Opcional <code>pathXMLDistribuicao</code> Define onde os XMLs retornados pelo m\u00e9todo NFeDistribuicaoDFe ser\u00e3o salvos. Opcional <code>armazenarXMLAutorizacao</code> Define se o XML gerado na emiss\u00e3o de NF-e deve ser salvo. Opcional <code>pathXMLAutorizacao</code> Define onde o XML gerado na emiss\u00e3o de NF-e ser\u00e1 salvo. Opcional <code>armazenarXMLConsulta</code> Define se os XMLs de consulta (gerados pela lib) e Retorno (retornados pela SEFAZ) ser\u00e3o salvos. Opcional <code>pathXMLConsulta</code> Define onde os XMLs de consulta (gerados pela lib) e os XML de retorno (retornados pela SEFAZ) ser\u00e3o salvos. Opcional <code>armazenarXMLConsultaComTagSoap</code> Define se os XMLs de consulta (gerados pela lib) devem ser armazenados com a tag soap. Opcional <code>armazenarXMLRetorno</code> Define se os XMLs de consulta (gerados pela lib) e Retorno (retornados pela SEFAZ) ser\u00e3o salvos. Opcional <code>pathXMLRetorno</code> Define onde os XMLs de consulta (gerados pela lib) e os XML de retorno (retornados pela SEFAZ) ser\u00e3o salvos. Opcional <code>armazenarRetornoEmJSON</code> Define se o retorno da SEFAZ dever\u00e1 ser salvo em JSON. Opcional <code>pathRetornoEmJSON</code> Define onde o arquivo JSON gerado a partir do retorno da SEFAZ ser\u00e1 salvo. Opcional <code>incluirTimestampNoNomeDosArquivos</code> Define se dever\u00e3o ser inclu\u00eddos data e hora no fim do nome dos arquivos (Aplicados apenas nos arquivos do XMLRetorno e XMLConsulta). Opcional <code>pathCertificado</code> Caminho e nome do certificado digital. Obrigat\u00f3rio <code>senhaCertificado</code> Senha do certificado digital. Obrigat\u00f3rio <code>UF</code> UF da pessoa vinculada ao certificado digital. Opcional <code>CPFCNPJ</code> CPF/CNPJ da pessoa vinculada ao certificado digital. Opcional"},{"location":"configuracaoDeAmbiente/#nfe","title":"NFE","text":"Chave Descri\u00e7\u00e3o Required <code>ambiente</code> Define o ambiente que receber\u00e1 os XML da NF-e:1 = Produ\u00e7\u00e3o2 = Homologa\u00e7\u00e3o Obrigat\u00f3rio <code>versaoDF</code> Define a vers\u00e3o da NF-e (Testada apenas 4.00):2.00 = Vers\u00e3o 2.003.00 = Vers\u00e3o 3.003.10 = Vers\u00e3o 3.104.00 = Vers\u00e3o 4.00 Obrigat\u00f3rio"},{"location":"configuracaoDeAmbiente/#email","title":"EMAIL","text":"Chave Descri\u00e7\u00e3o Required <code>host</code> Host SMTP do seu provedor de e-mail Obrigat\u00f3rio <code>port</code> Porta do servidor SMTP Obrigat\u00f3rio <code>secure</code> <code>true</code> para SSL, <code>false</code> para outros Obrigat\u00f3rio <code>auth</code> Dados para autentica\u00e7\u00e3o no servidor SMTP Obrigat\u00f3rio <code>auth.user</code> Seu e-mail para autentica\u00e7\u00e3o no servidor SMTP Obrigat\u00f3rio <code>auth.pass</code> Sua senha para autentica\u00e7\u00e3o no servidor SMTP Obrigat\u00f3rio <code>emailParams</code> Dados para envio do e-mail Obrigat\u00f3rio <code>emailParams.from</code> Remetente padr\u00e3o Obrigat\u00f3rio <code>emailParams.to</code> Destinat\u00e1rio padr\u00e3o Obrigat\u00f3rio <code>emailParams.subject</code> Assunto padr\u00e3o"},{"location":"configuracaoDeAmbiente/#lib","title":"LIB","text":"Chave Descri\u00e7\u00e3o Required <code>connection</code> Define configura\u00e7\u00f5es das requisi\u00e7\u00f5es Opcional <code>connection.timeout</code> Define o tempo limite em milissegundos para as requisi\u00e7\u00f5es HTTP feitas pela lib Opcional, padr\u00e3o: 60000 <code>log</code> Define configura\u00e7\u00f5es de log Opcional <code>log.exibirLogNoConsole</code> Define se os logs devem ser exibidos no console (Em desenvolvimento) Opcional, padr\u00e3o: false"},{"location":"nfeAutorizacao/","title":"NFeAutorizacao","text":"<p><code>Fun\u00e7\u00e3o</code>: Servi\u00e7o destinado \u00e0 recep\u00e7\u00e3o de mensagens de lote de NF-e. <code>Processo</code>: ass\u00edncrono/s\u00edncrono. <code>M\u00e9todo</code>: nfeAutorizacaoLote</p> <p></p> <p>O M\u00e9todo NFE_Autorizacao pode receber um array que possua at\u00e9 50 NF-e, seguindo defini\u00e7\u00e3o do <code>Leiaute da NF-e</code>. </p> <p>Interface de Entrada</p> <p>A interface de entrada da NF-e \u00e9 muito extensa. Para consulta-la verifique a documenta\u00e7\u00e3o em <code>Leiaute da NF-e</code>.</p>"},{"location":"nfeAutorizacao/#nfe_autorizacao","title":"<code>NFE_Autorizacao</code>","text":"<p>NFE_Autorizacao<pre><code>import { NFe } from '@Protocols';\n\nconst autorizacao: NFe = {\n    indSinc: 0,\n    idLote: 1,\n    NFe: [\n        {\n            infNFe: {\n                ide: {\n                    cUF: 35,\n                    cNF: '99999999',\n                    natOp: \"VENDA DE MERCADORIA\",\n                    mod: 55,\n                    serie: '1',\n                    nNF: 999999999,\n                    dhEmi: \"2024-07-08T00:00:00-03:00\",\n                    tpNF: 1,\n                    idDest: 1,\n                    cMunFG: 9999999,\n                    tpImp: 1,\n                    tpEmis: 1,\n                    cDV: 0,\n                    tpAmb: 2,\n                    finNFe: 1,\n                    indFinal: 1,\n                    indPres: 9,\n                    indIntermed: 0,\n                    procEmi: 0,\n                },\n                emit: {\n                    CNPJCPF: '99999999999999',\n                    xNome: \"NOME EMITENTE\",\n                    xFant: \"NOME FANT EMITENTE\",\n                    enderEmit: {\n                        xLgr: \"RUA X\",\n                        nro: '12x',\n                        xBairro: \"BAIRRO\",\n                        cMun: 9999999,\n                        xMun: \"MUNICIPIO\",\n                        UF: \"SP\",\n                        CEP: '99999999',\n                        cPais: 9999,\n                        xPais: \"BRASIL\",\n                        fone: \"99999999999\",\n                    },\n                    IE: \"999999999999\",\n                    CRT: 3\n                },\n                dest: {\n                    CNPJCPF: '99999999999999',\n                    xNome: \"NF-E EMITIDA EM AMBIENTE DE HOMOLOGACAO - SEM VALOR FISCAL\",\n                    enderDest: {\n                        xLgr: \"RUA Y\",\n                        nro: \"9999\",\n                        xBairro: \"BAIRRO\",\n                        cMun: 9999999,\n                        xMun: \"MUNICIPIO\",\n                        UF: \"SP\",\n                        CEP: '99999999',\n                        cPais: 9999,\n                        xPais: \"BRASIL\",\n                        fone: \"99999999999\"\n                    },\n                    indIEDest: 1,\n                    IE: \"999999999999\"\n                },\n                det: [\n                    {\n                        prod: {\n                            cProd: \"99999999\",\n                            cEAN: \"9999999999999\",\n                            xProd: \"QUEIJO MUSSARELA \",\n                            NCM: \"99999999\",\n                            EXTIPI: \"00\",\n                            CFOP: 5102,\n                            uCom: \"KG\",\n                            qCom: 24.93,\n                            vUnCom: \"33.9\",\n                            vProd: \"845.13\",\n                            cEANTrib: \"9999999999999\",\n                            uTrib: \"KG\",\n                            qTrib: 24.93,\n                            vUnTrib: \"33.9\",\n                            indTot: 1,\n                        },\n                        imposto: {\n                            ICMS: {\n                                ICMS00: {\n                                    orig: 0,\n                                    CST: \"00\",\n                                    modBC: 3,\n                                    vBC: \"845.13\",\n                                    pICMS: \"12.00\",\n                                    vICMS: \"101.42\"\n                                }\n                            },\n                            PIS: {\n                                PISNT: {\n                                    CST: \"06\",\n                                }\n                            },\n                            COFINS: {\n                                COFINSNT: {\n                                    CST: \"06\",\n                                }\n                            }\n                        },\n                    },\n                ],\n                total: {\n                    ICMSTot: {\n                        vBC: \"845.13\",\n                        vICMS: \"101.42\",\n                        vICMSDeson: \"0.00\",\n                        vFCP: \"0.00\",\n                        vBCST: \"0.00\",\n                        vST: \"0.00\",\n                        vFCPST: \"0.00\",\n                        vFCPSTRet: \"0.00\",\n                        vProd: \"845.13\",\n                        vFrete: \"0.00\",\n                        vSeg: \"0.00\",\n                        vDesc: \"0.00\",\n                        vII: \"0.00\",\n                        vIPI: \"0.00\",\n                        vIPIDevol: \"0.00\",\n                        vPIS: \"0.00\",\n                        vCOFINS: \"0.00\",\n                        vOutro: \"0.00\",\n                        vNF: \"845.13\",\n                    }\n                },\n                transp: {\n                    modFrete: 0,\n                    vol: [\n                        {\n                            qVol: 1,\n                            esp: \"CAIXA(S)\",\n                            marca: \"MARCA\",\n                            pesoL: \"24.930\",\n                            pesoB: \"24.930\"\n                        }\n                    ]\n                },\n                pag: {\n                    detPag: [\n                        {\n                            indPag: 1,\n                            tPag: 99,\n                            xPag: \"Outros\",\n                            vPag: \"845.13\"\n                        }\n                    ]\n                },\n            },\n        },\n    ],\n};\n\nawait nfewizard.NFE_Autorizacao(autorizacao);\n</code></pre> </p> <p><code>Retorno</code>:</p> <p>Interface de Retorno</p> <p>A interface de retorno da NF-e \u00e9 muito extensa. Para consulta-la verifique a documenta\u00e7\u00e3o em <code>Leiaute da NF-e</code>.</p> <pre><code>[\n  {\n    \"NFe\": {\n      \"infNFe\": {\n        \"ide\": {\n          \"cUF\": \"35\",\n          \"cNF\": \"99999999\",\n          \"natOp\": \"VENDA DE MERCADORIA\",\n          \"mod\": \"55\",\n          \"serie\": \"1\",\n          \"nNF\": \"999999999\",\n          \"dhEmi\": \"2024-07-08T00:00:00-03:00\",\n          \"tpNF\": \"1\",\n          \"idDest\": \"1\",\n          \"cMunFG\": \"9999999\",\n          \"tpImp\": \"1\",\n          \"tpEmis\": \"1\",\n          \"cDV\": \"9\",\n          \"tpAmb\": \"2\",\n          \"finNFe\": \"1\",\n          \"indFinal\": \"1\",\n          \"indPres\": \"9\",\n          \"indIntermed\": \"0\",\n          \"procEmi\": \"0\",\n          \"verProc\": \"1.0.0.0\"\n        },\n        \"emit\": {\n          \"CNPJ\": \"99999999999999\",\n          \"xNome\": \"NOME DO EMITENTE\",\n          \"xFant\": \"NOME FANTASIA DO EMITENTE\",\n          \"enderEmit\": {\n            \"xLgr\": \"DESCRI\u00c7\u00c3O LOGRADOURO EMITENTE\",\n            \"nro\": \"9999\",\n            \"xBairro\": \"BAIRRO EMITENTE\",\n            \"cMun\": \"9999999\",\n            \"xMun\": \"MUNICIPIO\",\n            \"UF\": \"SP\",\n            \"CEP\": \"99999999\",\n            \"cPais\": \"1058\",\n            \"xPais\": \"BRASIL\",\n            \"fone\": \"99999999999\"\n          },\n          \"IE\": \"999999999999\",\n          \"CRT\": \"3\"\n        },\n        \"dest\": {\n          \"CNPJ\": \"99999999999999\",\n          \"xNome\": \"NF-E EMITIDA EM AMBIENTE DE HOMOLOGACAO - SEM VALOR FISCAL\",\n          \"enderDest\": {\n            \"xLgr\": \"DESCRI\u00c7\u00c3O LOGRADOURO DESTINAT\u00c1RIO\",\n            \"nro\": \"9999\",\n            \"xBairro\": \"BAIRRO DESTINAT\u00c1RIO\",\n            \"cMun\": \"9999999\",\n            \"xMun\": \"MUNICIPIO\",\n            \"UF\": \"SP\",\n            \"CEP\": \"99999999\",\n            \"cPais\": \"1058\",\n            \"xPais\": \"BRASIL\",\n            \"fone\": \"99999999999\"\n          },\n          \"indIEDest\": \"1\",\n          \"IE\": \"999999999999\"\n        },\n        \"det\": {\n          \"prod\": {\n            \"cProd\": \"99999999\",\n            \"cEAN\": \"9999999999999\",\n            \"xProd\": \"QUEIJO MUSSARELA\",\n            \"NCM\": \"04061010\",\n            \"EXTIPI\": \"00\",\n            \"CFOP\": \"5102\",\n            \"uCom\": \"KG\",\n            \"qCom\": \"24.93\",\n            \"vUnCom\": \"33.9\",\n            \"vProd\": \"845.13\",\n            \"cEANTrib\": \"9999999999999\",\n            \"uTrib\": \"KG\",\n            \"qTrib\": \"24.93\",\n            \"vUnTrib\": \"33.9\",\n            \"indTot\": \"1\"\n          },\n          \"imposto\": {\n            \"ICMS\": {\n              \"ICMS00\": {\n                \"orig\": \"0\",\n                \"CST\": \"00\",\n                \"modBC\": \"3\",\n                \"vBC\": \"845.13\",\n                \"pICMS\": \"12.00\",\n                \"vICMS\": \"101.42\"\n              }\n            },\n            \"PIS\": {\n              \"PISNT\": {\n                \"CST\": \"06\"\n              }\n            },\n            \"COFINS\": {\n              \"COFINSNT\": {\n                \"CST\": \"06\"\n              }\n            }\n          }\n        },\n        \"total\": {\n          \"ICMSTot\": {\n            \"vBC\": \"845.13\",\n            \"vICMS\": \"101.42\",\n            \"vICMSDeson\": \"0.00\",\n            \"vFCP\": \"0.00\",\n            \"vBCST\": \"0.00\",\n            \"vST\": \"0.00\",\n            \"vFCPST\": \"0.00\",\n            \"vFCPSTRet\": \"0.00\",\n            \"vProd\": \"845.13\",\n            \"vFrete\": \"0.00\",\n            \"vSeg\": \"0.00\",\n            \"vDesc\": \"0.00\",\n            \"vII\": \"0.00\",\n            \"vIPI\": \"0.00\",\n            \"vIPIDevol\": \"0.00\",\n            \"vPIS\": \"0.00\",\n            \"vCOFINS\": \"0.00\",\n            \"vOutro\": \"0.00\",\n            \"vNF\": \"845.13\"\n          }\n        },\n        \"transp\": {\n          \"modFrete\": \"0\",\n          \"vol\": {\n            \"qVol\": \"1\",\n            \"esp\": \"CAIXA(S)\",\n            \"marca\": \"MARCA\",\n            \"pesoL\": \"24.930\",\n            \"pesoB\": \"24.930\"\n          }\n        },\n        \"pag\": {\n          \"detPag\": {\n            \"indPag\": \"1\",\n            \"tPag\": \"99\",\n            \"xPag\": \"Outros\",\n            \"vPag\": \"845.13\"\n          }\n        }\n      },\n      \"Signature\": {\n        \"SignedInfo\": {\n          \"CanonicalizationMethod\": {},\n          \"SignatureMethod\": {},\n          \"Reference\": {\n            \"Transforms\": {\n              \"Transform\": [\n                {},\n                {}\n              ]\n            },\n            \"DigestMethod\": {},\n            \"DigestValue\": \"qV+ghmu...\"\n          }\n        },\n        \"SignatureValue\": \"UwxIHUqkll0CN1...\",\n        \"KeyInfo\": {\n          \"X509Data\": {\n            \"X509Certificate\": \"MIIIHjCCBgagA...\"\n          }\n        }\n      }\n    },\n    \"protNFe\": {\n      \"infProt\": {\n        \"tpAmb\": \"2\",\n        \"verAplic\": \"SP_NFE_PL009_V4\",\n        \"chNFe\": \"99999999999999999999999999999999999999999999\",\n        \"dhRecbto\": \"2024-07-17T15:56:46-03:00\",\n        \"nProt\": \"999999999999999\",\n        \"digVal\": \"qV+ghmu...\",\n        \"cStat\": \"100\",\n        \"xMotivo\": \"Autorizado o uso da NF-e\"\n      }\n    },\n    \"xml\": \"&lt;?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?&gt;&lt;nfeProc versao=\\\"4.00\\\" xmlns=\\\"http://www.portalfiscal.inf.br/nfe\\\"&gt;&lt;NFe xmlns=\\\"http://www.portalfiscal.inf.br/nfe\\\"&gt;&lt;infNFe versao=\\\"4.00\\\" Id=\\\"NFe99999999999999999999999999999999999999999999\\\"&gt;&lt;ide&gt;&lt;cUF&gt;35&lt;/cUF&gt;&lt;cNF&gt;99999999&lt;/cNF&gt;&lt;natOp&gt;VENDA DE MERCADORIA&lt;/natOp&gt;&lt;mod&gt;55&lt;/mod&gt;&lt;serie&gt;1&lt;/serie&gt;&lt;nNF&gt;999999999&lt;/nNF&gt;&lt;dhEmi&gt;2024-07-08T00:00:00-03:00&lt;/dhEmi&gt;&lt;tpNF&gt;1&lt;/tpNF&gt;&lt;idDest&gt;1&lt;/idDest&gt;&lt;cMunFG&gt;9999999&lt;/cMunFG&gt;&lt;tpImp&gt;1&lt;/tpImp&gt;&lt;tpEmis&gt;1&lt;/tpEmis&gt;&lt;cDV&gt;9&lt;/cDV&gt;&lt;tpAmb&gt;2&lt;/tpAmb&gt;&lt;finNFe&gt;1&lt;/finNFe&gt;&lt;indFinal&gt;1&lt;/indFinal&gt;&lt;indPres&gt;9&lt;/indPres&gt;&lt;indIntermed&gt;0&lt;/indIntermed&gt;&lt;procEmi&gt;0&lt;/procEmi&gt;&lt;verProc&gt;1.0.0.0&lt;/verProc&gt;&lt;/ide&gt;&lt;emit&gt;&lt;CNPJ&gt;99999999999999&lt;/CNPJ&gt;&lt;xNome&gt;NOME DO EMITENTE&lt;/xNome&gt;&lt;xFant&gt;NOME FANTASIA DO EMITENTE&lt;/xFant&gt;&lt;enderEmit&gt;&lt;xLgr&gt;DESCRI\u00c7\u00c3O LOGRADOURO EMITENTE EMITENTE&lt;/xLgr&gt;&lt;nro&gt;9999&lt;/nro&gt;&lt;xBairro&gt;BAIRRO EMITENTE&lt;/xBairro&gt;&lt;cMun&gt;9999999&lt;/cMun&gt;&lt;xMun&gt;MUNICIPIO&lt;/xMun&gt;&lt;UF&gt;SP&lt;/UF&gt;&lt;CEP&gt;99999999&lt;/CEP&gt;&lt;cPais&gt;1058&lt;/cPais&gt;&lt;xPais&gt;BRASIL&lt;/xPais&gt;&lt;fone&gt;99999999999&lt;/fone&gt;&lt;/enderEmit&gt;&lt;IE&gt;999999999999&lt;/IE&gt;&lt;CRT&gt;3&lt;/CRT&gt;&lt;/emit&gt;&lt;dest&gt;&lt;CNPJ&gt;99999999999999&lt;/CNPJ&gt;&lt;xNome&gt;NF-E EMITIDA EM AMBIENTE DE HOMOLOGACAO - SEM VALOR FISCAL&lt;/xNome&gt;&lt;enderDest&gt;&lt;xLgr&gt;DESCRI\u00c7\u00c3O LOGRADOURO DESTINAT\u00c1RIO&lt;/xLgr&gt;&lt;nro&gt;9999&lt;/nro&gt;&lt;xBairro&gt;BAIRRO DESTINATARIO&lt;/xBairro&gt;&lt;cMun&gt;9999999&lt;/cMun&gt;&lt;xMun&gt;MUNICIPIO&lt;/xMun&gt;&lt;UF&gt;SP&lt;/UF&gt;&lt;CEP&gt;99999999&lt;/CEP&gt;&lt;cPais&gt;1058&lt;/cPais&gt;&lt;xPais&gt;BRASIL&lt;/xPais&gt;&lt;fone&gt;99999999999&lt;/fone&gt;&lt;/enderDest&gt;&lt;indIEDest&gt;1&lt;/indIEDest&gt;&lt;IE&gt;999999999999&lt;/IE&gt;&lt;/dest&gt;&lt;det nItem=\\\"1\\\"&gt;&lt;prod&gt;&lt;cProd&gt;99999999&lt;/cProd&gt;&lt;cEAN&gt;9999999999999&lt;/cEAN&gt;&lt;xProd&gt;QUEIJO MUSSARELA 4,0 KG (6 X 4)&lt;/xProd&gt;&lt;NCM&gt;04061010&lt;/NCM&gt;&lt;EXTIPI&gt;00&lt;/EXTIPI&gt;&lt;CFOP&gt;5102&lt;/CFOP&gt;&lt;uCom&gt;KG&lt;/uCom&gt;&lt;qCom&gt;24.93&lt;/qCom&gt;&lt;vUnCom&gt;33.9&lt;/vUnCom&gt;&lt;vProd&gt;845.13&lt;/vProd&gt;&lt;cEANTrib&gt;9999999999999&lt;/cEANTrib&gt;&lt;uTrib&gt;KG&lt;/uTrib&gt;&lt;qTrib&gt;24.93&lt;/qTrib&gt;&lt;vUnTrib&gt;33.9&lt;/vUnTrib&gt;&lt;indTot&gt;1&lt;/indTot&gt;&lt;/prod&gt;&lt;imposto&gt;&lt;ICMS&gt;&lt;ICMS00&gt;&lt;orig&gt;0&lt;/orig&gt;&lt;CST&gt;00&lt;/CST&gt;&lt;modBC&gt;3&lt;/modBC&gt;&lt;vBC&gt;845.13&lt;/vBC&gt;&lt;pICMS&gt;12.00&lt;/pICMS&gt;&lt;vICMS&gt;101.42&lt;/vICMS&gt;&lt;/ICMS00&gt;&lt;/ICMS&gt;&lt;PIS&gt;&lt;PISNT&gt;&lt;CST&gt;06&lt;/CST&gt;&lt;/PISNT&gt;&lt;/PIS&gt;&lt;COFINS&gt;&lt;COFINSNT&gt;&lt;CST&gt;06&lt;/CST&gt;&lt;/COFINSNT&gt;&lt;/COFINS&gt;&lt;/imposto&gt;&lt;/det&gt;&lt;total&gt;&lt;ICMSTot&gt;&lt;vBC&gt;845.13&lt;/vBC&gt;&lt;vICMS&gt;101.42&lt;/vICMS&gt;&lt;vICMSDeson&gt;0.00&lt;/vICMSDeson&gt;&lt;vFCP&gt;0.00&lt;/vFCP&gt;&lt;vBCST&gt;0.00&lt;/vBCST&gt;&lt;vST&gt;0.00&lt;/vST&gt;&lt;vFCPST&gt;0.00&lt;/vFCPST&gt;&lt;vFCPSTRet&gt;0.00&lt;/vFCPSTRet&gt;&lt;vProd&gt;845.13&lt;/vProd&gt;&lt;vFrete&gt;0.00&lt;/vFrete&gt;&lt;vSeg&gt;0.00&lt;/vSeg&gt;&lt;vDesc&gt;0.00&lt;/vDesc&gt;&lt;vII&gt;0.00&lt;/vII&gt;&lt;vIPI&gt;0.00&lt;/vIPI&gt;&lt;vIPIDevol&gt;0.00&lt;/vIPIDevol&gt;&lt;vPIS&gt;0.00&lt;/vPIS&gt;&lt;vCOFINS&gt;0.00&lt;/vCOFINS&gt;&lt;vOutro&gt;0.00&lt;/vOutro&gt;&lt;vNF&gt;845.13&lt;/vNF&gt;&lt;/ICMSTot&gt;&lt;/total&gt;&lt;transp&gt;&lt;modFrete&gt;0&lt;/modFrete&gt;&lt;vol&gt;&lt;qVol&gt;1&lt;/qVol&gt;&lt;esp&gt;CAIXA(S)&lt;/esp&gt;&lt;marca&gt;MARCA&lt;/marca&gt;&lt;pesoL&gt;24.930&lt;/pesoL&gt;&lt;pesoB&gt;24.930&lt;/pesoB&gt;&lt;/vol&gt;&lt;/transp&gt;&lt;pag&gt;&lt;detPag&gt;&lt;indPag&gt;1&lt;/indPag&gt;&lt;tPag&gt;99&lt;/tPag&gt;&lt;xPag&gt;Outros&lt;/xPag&gt;&lt;vPag&gt;845.13&lt;/vPag&gt;&lt;/detPag&gt;&lt;/pag&gt;&lt;/infNFe&gt;&lt;Signature xmlns=\\\"http://www.w3.org/2000/09/xmldsig#\\\"&gt;&lt;SignedInfo&gt;&lt;CanonicalizationMethod Algorithm=\\\"http://www.w3.org/TR/2001/REC-xml-c14n-20010315\\\"/&gt;&lt;SignatureMethod Algorithm=\\\"http://www.w3.org/2000/09/xmldsig#rsa-sha1\\\"/&gt;&lt;Reference URI=\\\"#NFe99999999999999999999999999999999999999999999\\\"&gt;&lt;Transforms&gt;&lt;Transform Algorithm=\\\"http://www.w3.org/2000/09/xmldsig#enveloped-signature\\\"/&gt;&lt;Transform Algorithm=\\\"http://www.w3.org/TR/2001/REC-xml-c14n-20010315\\\"/&gt;&lt;/Transforms&gt;&lt;DigestMethod Algorithm=\\\"http://www.w3.org/2000/09/xmldsig#sha1\\\"/&gt;&lt;DigestValue&gt;qV+ghmu...&lt;/DigestValue&gt;&lt;/Reference&gt;&lt;/SignedInfo&gt;&lt;SignatureValue&gt;UwxIHUqkll0CN1...&lt;/SignatureValue&gt;&lt;KeyInfo&gt;&lt;X509Data&gt;&lt;X509Certificate&gt;MIIIHjCCBgagA...&lt;/X509Certificate&gt;&lt;/X509Data&gt;&lt;/KeyInfo&gt;&lt;/Signature&gt;&lt;/NFe&gt;&lt;protNFe versao=\\\"4.00\\\"&gt;&lt;infProt&gt;&lt;tpAmb&gt;2&lt;/tpAmb&gt;&lt;verAplic&gt;SP_NFE_PL009_V4&lt;/verAplic&gt;&lt;chNFe&gt;99999999999999999999999999999999999999999999&lt;/chNFe&gt;&lt;dhRecbto&gt;2024-07-17T15:56:46-03:00&lt;/dhRecbto&gt;&lt;nProt&gt;999999999999999&lt;/nProt&gt;&lt;digVal&gt;qV+ghmu...&lt;/digVal&gt;&lt;cStat&gt;100&lt;/cStat&gt;&lt;xMotivo&gt;Autorizado o uso da NF-e&lt;/xMotivo&gt;&lt;/infProt&gt;&lt;/protNFe&gt;&lt;/nfeProc&gt;\"\n  }\n]\n</code></pre> <p> Para mais informa\u00e7\u00f5es sobre o processo consulte <code>Web Service \u2013 NfeAutorizacao</code>. </p>"},{"location":"nfeAutorizacao/#observacoes","title":"Observa\u00e7\u00f5es","text":"<p>Aten\u00e7\u00e3o</p> <p><code>ATEN\u00c7\u00c3O</code>: O m\u00e9todo <code>NFE_Autorizacao</code> foi testado apenas com documentos modelo 55 (NF-e) estando pendente de teste para modelo 65 (NFC-e).</p> <p></p>"},{"location":"nfeConsultaProtocolo/","title":"NFeConsulta Protocolo","text":"<p><code>Fun\u00e7\u00e3o</code>: Servi\u00e7o destinado ao atendimento de solicita\u00e7\u00f5es de consulta da situa\u00e7\u00e3o atual da NF-e na Base de Dados do Portal da Secretaria de Fazenda \u00a0Estadual. <code>Processo</code>: s\u00edncrono. <code>M\u00e9todo</code>: nfeConsulta</p> <p></p> Interface de Entrada Chave Tipo Descri\u00e7\u00e3o <code>chNFe</code> String Chave de acesso da NFe <p>NFE_ConsultaStatusServico<pre><code>await nfewizard.NFE_ConsultaProtocolo('99999999999999999999999999999999999999999999');\n</code></pre> </p> <p><code>Retorno</code>:</p> Interface de Retorno Chave Tipo Descri\u00e7\u00e3o <code>tpAmb</code> Number Identifica\u00e7\u00e3o do Ambiente: 1- Produ\u00e7\u00e3o; 2- Homologa\u00e7\u00e3o. <code>verAplic</code> String Vers\u00e3o do Aplicativo que recebeu a Consulta. <code>cStat</code> String C\u00f3digo do status da resposta para o Lote. <code>xMotivo</code> String Descri\u00e7\u00e3o literal do status da resposta. <code>cUF</code> String C\u00f3digo da UF que atendeu a solicita\u00e7\u00e3o. <code>dhRecbto</code> String Preenchido com a data e hora do processamento (informado tamb\u00e9m no caso de rejei\u00e7\u00e3o). Formato: \u201cAAAA-MM-DDThh:m m:ssTZD\u201d (UTC \u2013Universal Coordinated Time). <code>chNFe</code> String Chave de Acesso da NF-e consultada. <code>nProt</code> String N\u00famero do protocolo de autoriza\u00e7\u00e3o. <code>digVal</code> String Valor do digest (hash) da assinatura digital do documento fiscal. <code>xml</code> String Retorno original da SEFAZ (XML) convertido para String. <pre><code>{\n  \"tpAmb\": \"2\",\n  \"verAplic\": \"SP_NFE_PL009_V4\",\n  \"cStat\": \"100\",\n  \"xMotivo\": \"Autorizado o uso da NF-e\",\n  \"cUF\": \"35\",\n  \"dhRecbto\": \"2024-07-16T17:21:44-03:00\",\n  \"chNFe\": \"99999999999999999999999999999999999999999999\",\n  \"protNFe\": {\n    \"infProt\": {\n      \"tpAmb\": \"2\",\n      \"verAplic\": \"SP_NFE_PL009_V4\",\n      \"chNFe\": \"99999999999999999999999999999999999999999999\",\n      \"dhRecbto\": \"2024-07-14T09:57:08-03:00\",\n      \"nProt\": \"999999999999999\",\n      \"digVal\": \"\",\n      \"cStat\": \"100\",\n      \"xMotivo\": \"Autorizado o uso da NF-e\"\n    }\n  },\n  \"xml\": \"&lt;?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?&gt; &lt;soap:Envelope xmlns:soap=\\\"http://www.w3.org/2003/05/soap-envelope\\\" xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xmlns:xsd=\\\"http://www.w3.org/2001/XMLSchema\\\"&gt; &lt;soap:Body&gt; &lt;nfeResultMsg xmlns=\\\"http://www.portalfiscal.inf.br/nfe/wsdl/NFeConsultaProtocolo4\\\"&gt; &lt;retConsSitNFe versao=\\\"4.00\\\" xmlns=\\\"http://www.portalfiscal.inf.br/nfe\\\"&gt; &lt;tpAmb&gt;1&lt;/tpAmb&gt; &lt;verAplic&gt;SP_NFE_PL009_V4&lt;/verAplic&gt; &lt;cStat&gt;100&lt;/cStat&gt; &lt;xMotivo&gt;Autorizado o uso da NF-e&lt;/xMotivo&gt; &lt;cUF&gt;35&lt;/cUF&gt; &lt;dhRecbto&gt;2024-07-11T21:51:46-03:00&lt;/dhRecbto&gt; &lt;chNFe&gt;99999999999999999999999999999999999999999999&lt;/chNFe&gt; &lt;protNFe versao=\\\"4.00\\\"&gt; &lt;infProt&gt; &lt;tpAmb&gt;1&lt;/tpAmb&gt; &lt;verAplic&gt;SP_NFE_PL009_V4&lt;/verAplic&gt; &lt;chNFe&gt;99999999999999999999999999999999999999999999&lt;/chNFe&gt; &lt;dhRecbto&gt;2024-02-06T15:36:49-03:00&lt;/dhRecbto&gt; &lt;nProt&gt;&lt;/nProt&gt; &lt;digVal&gt;&lt;/digVal&gt; &lt;cStat&gt;100&lt;/cStat&gt; &lt;xMotivo&gt;Autorizado o uso da NF-e&lt;/xMotivo&gt; &lt;/infProt&gt; &lt;/protNFe&gt; &lt;/retConsSitNFe&gt; &lt;/nfeResultMsg&gt; &lt;/soap:Body&gt; &lt;/soap:Envelope&gt;\"\n}\n</code></pre> <p> Para mais informa\u00e7\u00f5es sobre o processo consulte <code>Web Service \u2013 NfeConsultaProtocolo</code>. </p>"},{"location":"nfeDistribuicaoDfe/","title":"NFeDistribuicaoDFe","text":"<p><code>Fun\u00e7\u00e3o</code>: Servi\u00e7o para consultar o cadastro de contribuintes do ICMS da unidade federada. <code>Processo</code>: s\u00edncrono. <code>M\u00e9todo</code>: nfeDistDFeInteresse</p> <p></p> <p>O M\u00e9todo NFE_DistribuicaoDFe pode receber um objeto que atenda qualquer um dos tipos de distribui\u00e7\u00e3o, sendo eles:</p> <ul> <li><code>ultNSU</code>: Consulta a partir do \u00faltimo NSU recebido.</li> <li><code>NSU</code>: Consulta NSU espec\u00edfico.</li> <li><code>chNFe</code>: Consulta por chave de acesso espec\u00edfica. </li> </ul> Interface de Entrada Chave Tipo Descri\u00e7\u00e3o <code>cUFAutor</code> Number C\u00f3digo da UF do Autor <code>CNPJ</code> String CNPJ do interessado no DF-e <code>ultNSU</code> String \u00daltimo N\u00famero Sequencial \u00danico recebido pelo ator <code>NSU</code> String N\u00famero Sequencial \u00danico <code>chNFe</code> String Chave de acesso espec\u00edfica"},{"location":"nfeDistribuicaoDfe/#nfe_distribuicaodfe","title":"<code>NFE_DistribuicaoDFe</code>","text":"<p>NFE_DistribuicaoDFe<pre><code>import { ConsultaNFe } from '@Protocols';\n\nconst distribuicao: ConsultaNFe = {\n    cUFAutor: 35,\n    CNPJ: '99999999999999',\n    // Apenas um dos objetos abaixo deve ser informado\n    distNSU: {\n        ultNSU: '000000000000000',\n    },\n    consNSU: {\n        NSU: '000000000000000',\n    },\n    consChNFe: {\n        chNFe: '99999999999999999999999999999999999999999999',\n    }\n}\n\nawait nfewizard.NFE_DistribuicaoDFe(distribuicao);\n</code></pre>  Tamb\u00e9m \u00e9 poss\u00edvel utilizar o m\u00e9todo especifico para cada tipo de distribui\u00e7\u00e3o: </p>"},{"location":"nfeDistribuicaoDfe/#nfe_distribuicaodfeporultnsu","title":"<code>NFE_DistribuicaoDFePorUltNSU</code>","text":"NFE_DistribuicaoDFePorUltNSU<pre><code>import { DFePorUltimoNSU } from '@Protocols';\n\nconst ultimoNSU: DFePorUltimoNSU = {\n    cUFAutor: 35,\n    CNPJ: '99999999999999',\n    distNSU: {\n        ultNSU: '000000000000001'\n    },\n}\n\nawait nfewizard.NFE_DistribuicaoDFePorUltNSU(ultimoNSU);\n</code></pre> <p><code>Retorno</code>:</p> Interface de Retorno Chave Tipo Descri\u00e7\u00e3o <code>tpAmb</code> Number Identifica\u00e7\u00e3o do Ambiente: 1- Produ\u00e7\u00e3o; 2- Homologa\u00e7\u00e3o. <code>verAplic</code> String Vers\u00e3o do Aplicativo que recebeu a Consulta. <code>cStat</code> String C\u00f3digo do status da resposta para o Lote. <code>xMotivo</code> String Descri\u00e7\u00e3o literal do status da resposta. <code>dhResp</code> String Data e hora da mensagem de Resposta. Formato:  \u201cAAAA-MMDDThh:m m:ssTZD\u201d (UTC \u2013 Universal Coordinated) <code>docZip</code> Array Informa\u00e7\u00e3o resumida ou documento fiscal eletr\u00f4nico de interesse da ou empresa. O conte\u00fado desta tag estar\u00e1 compactado no padr\u00e3o gZip. O tipo do campo \u00e9 base64Binary. <code>xml</code> String Retorno original da SEFAZ (XML) convertido para String. <pre><code>{\n  \"retDistDFeInt\": {\n    \"tpAmb\": \"1\",\n    \"verAplic\": \"1.7.1\",\n    \"cStat\": \"138\",\n    \"xMotivo\": \"Documento(s) localizado(s)\",\n    \"dhResp\": \"2024-07-16T17:58:27-03:00\",\n    \"ultNSU\": \"000000000006026\",\n    \"maxNSU\": \"000000000006068\",\n    \"loteDistDFeInt\": {\n      \"docZip\": [\n        \"H4sIAAAAAAAEAIWS3W...\",\n        \"H4sIAAAAAAAEAIVSXW...\",\n        \"H4sIAAAAAAAEAIWSbW...\",\n        \"H4sIAAAAAAAEAIWSy2...\",\n        \"H4sIAAAAAAAEAKVYaX...\"\n      ]\n    }\n  },\n  \"xml\": \"&lt;?xml version= \\\"1.0\\\" encoding= \\\"utf-8\\\"?&gt; &lt;soap:Envelope xmlns:soap= \\\"http://www.w3.org/2003/05/soap-envelope\\\" xmlns:xsi= \\\"http://www.w3.org/2001/XMLSchema-instance\\\" xmlns:xsd= \\\"http://www.w3.org/2001/XMLSchema\\\"&gt; &lt;soap:Body&gt; &lt;nfeDistDFeInteresseResponse xmlns= \\\"http://www.portalfiscal.inf.br/nfe/wsdl/NFeDistribuicaoDFe\\\"&gt; &lt;nfeDistDFeInteresseResult&gt; &lt;retDistDFeInt xmlns:xsd= \\\"http://www.w3.org/2001/XMLSchema\\\" xmlns:xsi= \\\"http://www.w3.org/2001/XMLSchema-instance\\\" versao= \\\"1.01\\\" xmlns= \\\"http://www.portalfiscal.inf.br/nfe\\\"&gt; &lt;tpAmb&gt;1&lt;/tpAmb&gt; &lt;verAplic&gt;1.7.1&lt;/verAplic&gt; &lt;cStat&gt;138&lt;/cStat&gt; &lt;xMotivo&gt;Documento(s) localizado(s)&lt;/xMotivo&gt; &lt;dhResp&gt;2024-07-16T17:58:27-03:00&lt;/dhResp&gt; &lt;ultNSU&gt;000000000006026&lt;/ultNSU&gt; &lt;maxNSU&gt;000000000006068&lt;/maxNSU&gt; &lt;loteDistDFeInt&gt; &lt;docZip NSU= \\\"000000000005977\\\" schema= \\\"resNFe_v1.01.xsd\\\"&gt; H4sIAAAAAAAEAIWS3W...&lt;/docZip&gt; &lt;docZip NSU= \\\"000000000005978\\\" schema= \\\"resNFe_v1.01.xsd\\\"&gt; H4sIAAAAAAAEAIVSXW...&lt;/docZip&gt; &lt;docZip NSU= \\\"000000000005979\\\" schema= \\\"resNFe_v1.01.xsd\\\"&gt; H4sIAAAAAAAEAIWSbW...&lt;/docZip&gt; &lt;docZip NSU= \\\"000000000005980\\\" schema= \\\"resNFe_v1.01.xsd\\\"&gt; H4sIAAAAAAAEAIWSy2...&lt;/docZip&gt; &lt;docZip NSU= \\\"000000000005981\\\" schema= \\\"procEventoNFe_v1.00.xsd\\\"&gt; H4sIAAAAAAAEAKVYaX...&lt;/docZip&gt; &lt;/loteDistDFeInt&gt; &lt;/retDistDFeInt&gt; &lt;/nfeDistDFeInteresseResult&gt; &lt;/nfeDistDFeInteresseResponse&gt; &lt;/soap:Body&gt; &lt;/soap:Envelope&gt;\"\n}\n</code></pre> <p></p>"},{"location":"nfeDistribuicaoDfe/#nfe_distribuicaodfepornsu","title":"<code>NFE_DistribuicaoDFePorNSU</code>","text":"NFE_DistribuicaoDFePorNSU<pre><code>import { DFePorNSU } from '@Protocols';\n\nconst nsu: DFePorNSU = {\n    cUFAutor: 35,\n    CNPJ: '99999999999999',\n    consNSU: {\n        NSU: '000000000000000'\n    },\n}\n\nawait nfewizard.NFE_DistribuicaoDFePorNSU(nsu);\n</code></pre> <p><code>Retorno</code>:</p> Interface de Retorno Chave Tipo Descri\u00e7\u00e3o <code>tpAmb</code> Number Identifica\u00e7\u00e3o do Ambiente: 1- Produ\u00e7\u00e3o; 2- Homologa\u00e7\u00e3o. <code>verAplic</code> String Vers\u00e3o do Aplicativo que recebeu a Consulta. <code>cStat</code> String C\u00f3digo do status da resposta para o Lote. <code>xMotivo</code> String Descri\u00e7\u00e3o literal do status da resposta. <code>dhResp</code> String Data e hora da mensagem de Resposta. Formato:  \u201cAAAA-MMDDThh:m m:ssTZD\u201d (UTC \u2013 Universal Coordinated) <code>docZip</code> String Informa\u00e7\u00e3o resumida ou documento fiscal eletr\u00f4nico de interesse da ou empresa. O conte\u00fado desta tag estar\u00e1 compactado no padr\u00e3o gZip. O tipo do campo \u00e9 base64Binary. <code>xml</code> String Retorno original da SEFAZ (XML) convertido para String. <pre><code>{\n  \"retDistDFeInt\": {\n    \"tpAmb\": \"1\",\n    \"verAplic\": \"1.7.1\",\n    \"cStat\": \"138\",\n    \"xMotivo\": \"Documento localizado\",\n    \"dhResp\": \"2024-07-16T17:43:35-03:00\",\n    \"loteDistDFeInt\": {\n      \"docZip\": \"H4sIAAAAAAAEANU6a5...\"\n    }\n  },\n  \"xml\": \"&lt;?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?&gt; &lt;soap:Envelope xmlns:soap=\\\"http://www.w3.org/2003/05/soap-envelope\\\" xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xmlns:xsd=\\\"http://www.w3.org/2001/XMLSchema\\\"&gt; &lt;soap:Body&gt; &lt;nfeDistDFeInteresseResponse xmlns=\\\"http://www.portalfiscal.inf.br/nfe/wsdl/NFeDistribuicaoDFe\\\"&gt; &lt;nfeDistDFeInteresseResult&gt; &lt;retDistDFeInt xmlns:xsd=\\\"http://www.w3.org/2001/XMLSchema\\\" xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" versao=\\\"1.01\\\" xmlns=\\\"http://www.portalfiscal.inf.br/nfe\\\"&gt; &lt;tpAmb&gt;2&lt;/tpAmb&gt; &lt;verAplic&gt;1.7.1&lt;/verAplic&gt; &lt;cStat&gt;138&lt;/cStat&gt; &lt;xMotivo&gt;Documento localizado&lt;/xMotivo&gt; &lt;dhResp&gt;2024-07-11T21:57:05-03:00&lt;/dhResp&gt; &lt;loteDistDFeInt&gt; &lt;docZip NSU=\\\"000000000000040\\\" schema=\\\"procNFe_v4.00.xsd\\\"&gt; &lt;/docZip&gt; &lt;/loteDistDFeInt&gt; &lt;/retDistDFeInt&gt; &lt;/nfeDistDFeInteresseResult&gt; &lt;/nfeDistDFeInteresseResponse&gt; &lt;/soap:Body&gt; &lt;/soap:Envelope&gt;\",\n}\n</code></pre> <p></p>"},{"location":"nfeDistribuicaoDfe/#nfe_distribuicaodfeporchave","title":"<code>NFE_DistribuicaoDFePorChave</code>","text":"NFE_DistribuicaoDFePorChave<pre><code>import { DFePorChaveNFe } from '@Protocols';\n\nconst chave: DFePorChaveNFe = {\n    cUFAutor: 35,\n    CNPJ: '99999999999999',\n    consChNFe: {\n         chNFe: '99999999999999999999999999999999999999999999'\n    },\n}\n\nawait nfewizard.NFE_DistribuicaoDFePorChave(chave);\n</code></pre> <p><code>Retorno</code>:</p> Interface de Retorno Chave Tipo Descri\u00e7\u00e3o <code>tpAmb</code> Number Identifica\u00e7\u00e3o do Ambiente: 1- Produ\u00e7\u00e3o; 2- Homologa\u00e7\u00e3o. <code>verAplic</code> String Vers\u00e3o do Aplicativo que recebeu a Consulta. <code>cStat</code> String C\u00f3digo do status da resposta para o Lote. <code>xMotivo</code> String Descri\u00e7\u00e3o literal do status da resposta. <code>dhResp</code> String Data e hora da mensagem de Resposta. Formato:  \u201cAAAA-MMDDThh:m m:ssTZD\u201d (UTC \u2013 Universal Coordinated) <code>docZip</code> String Informa\u00e7\u00e3o resumida ou documento fiscal eletr\u00f4nico de interesse da ou empresa. O conte\u00fado desta tag estar\u00e1 compactado no padr\u00e3o gZip. O tipo do campo \u00e9 base64Binary. <code>xml</code> String Retorno original da SEFAZ (XML) convertido para String. <pre><code>{\n  \"retDistDFeInt\": {\n    \"tpAmb\": \"1\",\n    \"verAplic\": \"1.7.1\",\n    \"cStat\": \"138\",\n    \"xMotivo\": \"Documento localizado\",\n    \"dhResp\": \"2024-07-16T17:43:35-03:00\",\n    \"loteDistDFeInt\": {\n      \"docZip\": \"H4sIAAAAAAAEANU6a5...\"\n    }\n  },\n  \"xml\": \"&lt;?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?&gt; &lt;soap:Envelope xmlns:soap=\\\"http://www.w3.org/2003/05/soap-envelope\\\" xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xmlns:xsd=\\\"http://www.w3.org/2001/XMLSchema\\\"&gt; &lt;soap:Body&gt; &lt;nfeDistDFeInteresseResponse xmlns=\\\"http://www.portalfiscal.inf.br/nfe/wsdl/NFeDistribuicaoDFe\\\"&gt; &lt;nfeDistDFeInteresseResult&gt; &lt;retDistDFeInt xmlns:xsd=\\\"http://www.w3.org/2001/XMLSchema\\\" xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" versao=\\\"1.01\\\" xmlns=\\\"http://www.portalfiscal.inf.br/nfe\\\"&gt; &lt;tpAmb&gt;2&lt;/tpAmb&gt; &lt;verAplic&gt;1.7.1&lt;/verAplic&gt; &lt;cStat&gt;138&lt;/cStat&gt; &lt;xMotivo&gt;Documento localizado&lt;/xMotivo&gt; &lt;dhResp&gt;2024-07-11T21:57:05-03:00&lt;/dhResp&gt; &lt;loteDistDFeInt&gt; &lt;docZip NSU=\\\"000000000000040\\\" schema=\\\"procNFe_v4.00.xsd\\\"&gt; &lt;/docZip&gt; &lt;/loteDistDFeInt&gt; &lt;/retDistDFeInt&gt; &lt;/nfeDistDFeInteresseResult&gt; &lt;/nfeDistDFeInteresseResponse&gt; &lt;/soap:Body&gt; &lt;/soap:Envelope&gt;\",\n}\n</code></pre> <p></p> <p> Para mais informa\u00e7\u00f5es sobre o processo consulte <code>Web Service \u2013 NfeDistribuicaoDFe</code>. </p>"},{"location":"nfeEnviaEmail/","title":"NFeEnviaEmail","text":"<p><code>Fun\u00e7\u00e3o</code>: M\u00e9todo destinado ao envio de e-mails. <code>Processo</code>: s\u00edncrono.</p> <p></p> <p>NFE_EnviaEmail<pre><code>const nfewizard = new NFeWizard();\n\nconst messageExample = `\n&lt;!DOCTYPE html&gt;\n&lt;html lang=\"pt-BR\"&gt;\n\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;\n    &lt;title&gt;Envio de NF-e e DANFE&lt;/title&gt;\n    &lt;style&gt;\n        body {\n            font-family: Arial, sans-serif;\n            background-color: #f4f4f4;\n            margin: 0;\n            padding: 0;\n        }\n\n        .container {\n            width: 100%;\n            max-width: 600px;\n            margin: 0 auto;\n            background-color: #ffffff;\n            padding: 20px;\n            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\n        }\n\n        .header {\n            background-color: #007BFF;\n            color: #ffffff;\n            padding: 10px 20px;\n            text-align: center;\n        }\n\n        .content {\n            margin: 20px 0;\n        }\n\n        .content h1 {\n            color: #333333;\n            font-size: 24px;\n        }\n\n        .content p {\n            color: #555555;\n            font-size: 16px;\n            line-height: 1.5;\n        }\n\n        .footer {\n            background-color: #007BFF;\n            color: #ffffff;\n            padding: 10px 20px;\n            text-align: center;\n        }\n\n        .footer p {\n            margin: 0;\n        }\n    &lt;/style&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n    &lt;div class=\"container\"&gt;\n        &lt;div class=\"header\"&gt;\n            &lt;h2&gt;Envio de NF-e e DANFE&lt;/h2&gt;\n        &lt;/div&gt;\n        &lt;div class=\"content\"&gt;\n            &lt;h1&gt;Prezado Cliente,&lt;/h1&gt;\n            &lt;p&gt;\n                Estamos enviando em anexo a Nota Fiscal Eletr\u00f4nica (NF-e) e o Documento Auxiliar da Nota Fiscal\n                Eletr\u00f4nica (DANFE) referente \u00e0 sua compra.\n            &lt;/p&gt;\n            &lt;p&gt;\n                Por favor, verifique os documentos anexos:\n            &lt;/p&gt;\n            &lt;ul&gt;\n                &lt;li&gt;DANFE.pdf&lt;/li&gt;\n                &lt;li&gt;35240706319316000127550011452380351650831257.json&lt;/li&gt;\n                &lt;li&gt;35240706319316000127550011452380351650831257.xml&lt;/li&gt;\n            &lt;/ul&gt;\n            &lt;p&gt;\n                Caso tenha alguma d\u00favida ou necessite de mais informa\u00e7\u00f5es, n\u00e3o hesite em nos contatar.\n            &lt;/p&gt;\n            &lt;p&gt;\n                Agradecemos pela sua prefer\u00eancia.\n            &lt;/p&gt;\n        &lt;/div&gt;\n        &lt;div class=\"footer\"&gt;\n            &lt;p&gt;\n                Atenciosamente,&lt;br&gt;\n                Equipe de Atendimento ao Cliente\n            &lt;/p&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n`;\n\nnfewizard.NFE_EnviaEmail({\n    messageExample,\n    subject: 'Envio de DANFE e NF-e',\n    attachments: [\n        {\n            filename: 'DANFE.pdf',\n            path: './tmp/Autorizacao/DANFE-99999999999999999999999999999999999999999999.pdf'\n        },\n        {\n            filename: '99999999999999999999999999999999999999999999.xml',\n            path: './tmp/Autorizacao/99999999999999999999999999999999999999999999.xml'\n        },\n    ]\n});\n</code></pre> </p> <p><code>Retorno</code>:</p> <p>Interface de Retorno</p> <p>E-mail enviado com sucesso.</p> <p></p>"},{"location":"nfeGerarDanfe/","title":"NFeGerarDanfe","text":"<p><code>Fun\u00e7\u00e3o</code>: M\u00e9todo destinado \u00e0 gerar DANFE com base num objeto do tipo NFe | NFeDanfe. <code>Processo</code>: ass\u00edncrono.</p> <p></p> <p>Interface de Entrada</p> <p>A interface de gera\u00e7\u00e3o da DANFE \u00e9 muito extensa. Para consulta-la verifique a documenta\u00e7\u00e3o em <code>DANFE e C\u00f3digo de Barras - 2.8.1. Formul\u00e1rio A-4 em Modo Retrato</code>.</p>"},{"location":"nfeGerarDanfe/#gerar-danfe","title":"<code>Gerar Danfe</code>","text":"<p>Voc\u00ea pode gerar a DANFE com o mesmo objeto com o qual transmitiu a NFe, por\u00e9m existem algumas regras:</p> <ul> <li>DANFE HOMOLOGA\u00c7\u00c3O: Caso a propriedade NFe.infNFe.ide.tpAmb = 2 (Homologa\u00e7\u00e3o) ser\u00e1 adicionada ao rodap\u00e9 da DANFE a tarja <code>AMBIENTE DE HOMOLOGA\u00c7\u00c3O - NF-E SEM VALOR FISCAL</code>.</li> <li>DANFE PRODU\u00c7\u00c3O: Caso a propriedade NFe.infNFe.ide.tpAmb = 1 (Produ\u00e7\u00e3o) e exista a propriedade protNFe a DANFE ser\u00e1 gerada de forma completa.</li> <li>DANFE PRODU\u00c7\u00c3O SEM protNFe: Caso a propriedade NFe.infNFe.ide.tpAmb = 1 (Produ\u00e7\u00e3o) e n\u00e3o exista a propriedade protNFe a DANFE ser\u00e1 gerada com a tarja <code>NF-E N\u00c3O ENVIADA PARA SEFAZ</code> sobre o c\u00f3digo de barras.  </li> </ul> <p>Exemplo de gera\u00e7\u00e3o da DANFE: </p> <p>NFE_GerarDanfe<pre><code>import { NFeDanfe, NFe } from '@Protocols';\n\nconst autorizacao: NFe | NFeDanfe = {\n    indSinc: 0,\n    idLote: 1,\n    NFe: [\n        {\n            infNFe: {\n                ide: {\n                    cUF: 35,\n                    cNF: '99999999',\n                    natOp: \"VENDA DE MERCADORIA\",\n                    mod: 55,\n                    serie: '1',\n                    nNF: 999999999,\n                    dhEmi: \"2024-07-08T00:00:00-03:00\",\n                    tpNF: 1,\n                    idDest: 1,\n                    cMunFG: 9999999,\n                    tpImp: 1,\n                    tpEmis: 1,\n                    cDV: 0,\n                    tpAmb: 2,\n                    finNFe: 1,\n                    indFinal: 1,\n                    indPres: 9,\n                    indIntermed: 0,\n                    procEmi: 0,\n                },\n                emit: {\n                    CNPJCPF: '99999999999999',\n                    xNome: \"NOME EMITENTE\",\n                    xFant: \"NOME FANT EMITENTE\",\n                    enderEmit: {\n                        xLgr: \"RUA X\",\n                        nro: '12x',\n                        xBairro: \"BAIRRO\",\n                        cMun: 9999999,\n                        xMun: \"MUNICIPIO\",\n                        UF: \"SP\",\n                        CEP: '99999999',\n                        cPais: 9999,\n                        xPais: \"BRASIL\",\n                        fone: \"99999999999\",\n                    },\n                    IE: \"999999999999\",\n                    CRT: 3\n                },\n                dest: {\n                    CNPJCPF: '99999999999999',\n                    xNome: \"NF-E EMITIDA EM AMBIENTE DE HOMOLOGACAO - SEM VALOR FISCAL\",\n                    enderDest: {\n                        xLgr: \"RUA Y\",\n                        nro: \"9999\",\n                        xBairro: \"BAIRRO\",\n                        cMun: 9999999,\n                        xMun: \"MUNICIPIO\",\n                        UF: \"SP\",\n                        CEP: '99999999',\n                        cPais: 9999,\n                        xPais: \"BRASIL\",\n                        fone: \"99999999999\"\n                    },\n                    indIEDest: 1,\n                    IE: \"999999999999\"\n                },\n                det: [\n                    {\n                        prod: {\n                            cProd: \"99999999\",\n                            cEAN: \"9999999999999\",\n                            xProd: \"QUEIJO MUSSARELA \",\n                            NCM: \"99999999\",\n                            EXTIPI: \"00\",\n                            CFOP: 5102,\n                            uCom: \"KG\",\n                            qCom: 24.93,\n                            vUnCom: \"33.9\",\n                            vProd: \"845.13\",\n                            cEANTrib: \"9999999999999\",\n                            uTrib: \"KG\",\n                            qTrib: 24.93,\n                            vUnTrib: \"33.9\",\n                            indTot: 1,\n                        },\n                        imposto: {\n                            ICMS: {\n                                ICMS00: {\n                                    orig: 0,\n                                    CST: \"00\",\n                                    modBC: 3,\n                                    vBC: \"845.13\",\n                                    pICMS: \"12.00\",\n                                    vICMS: \"101.42\"\n                                }\n                            },\n                            PIS: {\n                                PISNT: {\n                                    CST: \"06\",\n                                }\n                            },\n                            COFINS: {\n                                COFINSNT: {\n                                    CST: \"06\",\n                                }\n                            }\n                        },\n                    },\n                ],\n                total: {\n                    ICMSTot: {\n                        vBC: \"845.13\",\n                        vICMS: \"101.42\",\n                        vICMSDeson: \"0.00\",\n                        vFCP: \"0.00\",\n                        vBCST: \"0.00\",\n                        vST: \"0.00\",\n                        vFCPST: \"0.00\",\n                        vFCPSTRet: \"0.00\",\n                        vProd: \"845.13\",\n                        vFrete: \"0.00\",\n                        vSeg: \"0.00\",\n                        vDesc: \"0.00\",\n                        vII: \"0.00\",\n                        vIPI: \"0.00\",\n                        vIPIDevol: \"0.00\",\n                        vPIS: \"0.00\",\n                        vCOFINS: \"0.00\",\n                        vOutro: \"0.00\",\n                        vNF: \"845.13\",\n                    }\n                },\n                transp: {\n                    modFrete: 0,\n                    vol: [\n                        {\n                            qVol: 1,\n                            esp: \"CAIXA(S)\",\n                            marca: \"MARCA\",\n                            pesoL: \"24.930\",\n                            pesoB: \"24.930\"\n                        }\n                    ]\n                },\n                pag: {\n                    detPag: [\n                        {\n                            indPag: 1,\n                            tPag: 99,\n                            xPag: \"Outros\",\n                            vPag: \"845.13\"\n                        }\n                    ]\n                },\n            },\n        },\n    ],\n};\n\nawait nfewizard.NFE_GerarDanfe({\n    chave: '99999999999999999999999999999999999999999999',\n    data: {\n        NFe: autorizacao.NFe\n    },\n    outputPath: 'src/assets/DANFE.pdf'\n})\n</code></pre> </p> <p><code>Retorno</code>:</p> <p>Interface de Retorno</p> <p>O arquivo ser\u00e1 gerado com nome e caminho definidos na propriedade outputPath. Ex: outputPath: 'src/assets/DANFE.pdf'</p> <p></p>"},{"location":"nfeGerarDanfe/#gerar-danfe-com-retorno-do-metodo-nfeautorizacao","title":"<code>Gerar Danfe com retorno do m\u00e9todo NFEAutorizacao</code>","text":"<p>NFE_GerarDanfe<pre><code>import { NFeDanfe } from '@Protocols';\n\n// Transmite NFe\nconst autorizacao: NFeDanfe = {\n    // Segue o mesmo padr\u00e3o do exemplo anterior\n    indSinc: 0,\n    idLote: 1,\n    NFe: [...],\n};\n\nconst retorno = await nfewizard.NFE_Autorizacao(autorizacao);\n\n// Gera DANFE da NFe transmitida\nconst chave = retorno[0].protNFe.infProt.chNFe;\nawait nfewizard.NFE_GerarDanfe({\n    chave,\n    data: retorno[0],\n    outputPath: 'src/assets/DANFE.pdf'\n})\n</code></pre> </p> <p><code>Retorno</code>:</p> <p>Interface de Retorno</p> <p>O arquivo ser\u00e1 gerado com nome e caminho definidos na propriedade outputPath. Ex: outputPath: 'src/assets/DANFE.pdf'</p> <p></p>"},{"location":"nfeGerarDanfe/#gerar-danfe-com-multiplas-nfe","title":"<code>Gerar Danfe com multiplas NFe</code>","text":"<p>Aten\u00e7\u00e3o</p> <p><code>ATEN\u00c7\u00c3O</code>: O m\u00e9todo <code>NFE_GerarDanfe</code> aceita um par\u00e2metro data que pode ser um objeto contendo NFe (do tipo LayoutNFe ou um array de objetos LayoutNFe[]) e protNFe (do tipo protNFe). No entanto, se o par\u00e2metro data.NFe for um array, o m\u00e9todo gerar\u00e1 a DANFE apenas para o primeiro item do array.</p> <p>Se voc\u00ea precisa gerar a DANFE para cada nota fiscal presente em um array, deve chamar o m\u00e9todo <code>NFE_GerarDanfe</code> dentro de um loop, passando cada item do array individualmente:</p> NFE_GerarDanfe<pre><code>import { NFeDanfe } from '@Protocols';\n\n/**\n * Exemplo com NFe n\u00e3o transmitida\n*/\nconst autorizacao: NFeDanfe = {\n    indSinc: 0,\n    idLote: 1,\n    NFe: [...],\n};\n\nif (autorizacao.NFe instanceof Array) {\n    autorizacao.NFe.forEach(async (NFe: LayoutNFe) =&gt; {\n        await nfewizard.NFE_GerarDanfe({\n            chave: '99999999999999999999999999999999999999999999',\n            data: {\n                NFe,\n            },\n            outputPath: `src/assets/DANFE-${chave}.pdf`\n        })\n    });\n}\n\n\n/**\n * Exemplo com NFe j\u00e1 transmitida\n*/\n\nconst retorno = await nfewizard.NFE_Autorizacao(autorizacao);\n\nretorno.forEach(async (NFe) =&gt; {\n    const chave = NFe.protNFe.infProt.chNFe;\n    await nfewizard.NFE_GerarDanfe({\n        chave: chave,\n        data: NFe,\n        outputPath: `src/assets/DANFE-${chave}.pdf`\n    })\n});\n</code></pre> <p>Isso garantir\u00e1 que uma DANFE ser\u00e1 gerada para cada nota fiscal no array.</p> <p></p>"},{"location":"nfeGerarDanfe/#observacoes","title":"Observa\u00e7\u00f5es","text":"<p>Aten\u00e7\u00e3o</p> <p><code>ATEN\u00c7\u00c3O</code>: O m\u00e9todo <code>NFE_GerarDanfe</code> atualmente gera documentos apenas no formado <code>RETRATO</code>.</p> <p></p>"},{"location":"nfeInicializarAmbiente/","title":"Inicializar Ambiente","text":"<p>Reposit\u00f3rio do projeto nfewizard.</p> <p><code>ATEN\u00c7\u00c3O</code>: Ap\u00f3s a inicializa\u00e7\u00e3o do ambiente voc\u00ea ser\u00e1 capaz de utilizar a biblioteca para se comunicar com os webservices da SEFAZ. \u00c9 importante que os \u00a0objetos (dados) fornecidos aos m\u00e9todos da biblioteca estejam na mesma ordem dos exemplos, uma vez que os XML ser\u00e3o gerados na mesma ordem e \u00a0validados pelo webservice.</p> <p></p> <p>Para mais informa\u00e7\u00f5es sobre op\u00e7\u00f5es de configura\u00e7\u00e3o consulte a sess\u00e3o <code>Configura\u00e7\u00e3o de Ambiente</code>. </p> NFE_LoadEnvironment<pre><code>const nfewizard = new NFeWizard();\n\nawait nfewizard.NFE_LoadEnvironment({\n    config: {\n        dfe: {\n            baixarXMLDistribuicao: true,\n            pathXMLDistribuicao: \"tmp/DistribuicaoDFe\",\n            armazenarXMLAutorizacao: true,\n            pathXMLAutorizacao: \"tmp/Autorizacao\",\n            armazenarXMLRetorno: true,\n            pathXMLRetorno: \"tmp/RequestLogs\",\n            armazenarXMLConsulta: true,\n            pathXMLConsulta: \"tmp/RequestLogs\",\n            armazenarXMLConsultaComTagSoap: false,\n            armazenarRetornoEmJSON: true,\n            pathRetornoEmJSON: \"tmp/DistribuicaoDFe\",\n\n            pathCertificado: \"certificado.pfx\",\n            senhaCertificado: \"123456\",\n            UF: \"SP\",\n            CPFCNPJ: \"99999999999999\",\n        },\n        nfe: {\n            ambiente: 2,\n            versaoDF: \"4.00\",\n        },\n        email: {\n            host: 'smtp.example.com',\n            port: 587,\n            secure: false,\n            auth: {\n                user: 'seu-email@example.com',\n                pass: 'sua-senha'\n            },\n            emailParams: {\n                from: '\"Seu Nome\" &lt;seu-email@example.com&gt;',\n                to: 'destinatario@example.com',\n                subject: 'Assunto do E-mail',\n            }\n        },\n        lib: {\n            connection: {\n                timeout: 30000,\n            },\n        }\n    }\n});\n</code></pre>"},{"location":"nfeInutilizacao/","title":"NFeInutilizacao","text":"<p><code>Fun\u00e7\u00e3o</code>: Servi\u00e7o destinado ao atendimento de solicita\u00e7\u00f5es de inutiliza\u00e7\u00e3o de numera\u00e7\u00e3o. <code>Processo</code>: s\u00edncrono. <code>M\u00e9todo</code>: nfeInutilizacaoNF</p> <p></p> Interface de Entrada Chave Tipo Descri\u00e7\u00e3o <code>cUF</code> Number C\u00f3digo da UF do solicitante <code>CNPJ</code> String CNPJ do emitente <code>ano</code> String Ano de inutiliza\u00e7\u00e3o da numera\u00e7\u00e3o <code>mod</code> String Modelo do documento (55 ou 65) <code>serie</code> String S\u00e9rie da NF-e <code>nNFIni</code> String N\u00famero da NF-e inicial a ser inutilizada <code>nNFFin</code> String N\u00famero da NF-e final a ser inutilizada <code>xJust</code> String nformar a justificativa do pedido de inutiliza\u00e7\u00e3o <p>NFE_Inutilizacao<pre><code>import { InutilizacaoData } from '@Protocols';\n\nconst inutilizacao: InutilizacaoData = {\n    cUF: 35,\n    CNPJ: '99999999999999',\n    ano: '24',\n    mod: '55',\n    serie: '1',\n    nNFIni: '112',\n    nNFFin: '112',\n    xJust: 'Teste de homologa\u00e7\u00e3o',\n}\n\nawait nfewizard.NFE_Inutilizacao(inutilizacao)\n</code></pre> </p> <p><code>Retorno</code>:</p> Interface de Retorno Chave Tipo Descri\u00e7\u00e3o <code>tpAmb</code> Number Identifica\u00e7\u00e3o do Ambiente: 1- Produ\u00e7\u00e3o; 2- Homologa\u00e7\u00e3o. <code>verAplic</code> String Vers\u00e3o do Aplicativo que recebeu a Consulta. <code>cStat</code> String C\u00f3digo do status da resposta para o Lote. <code>xMotivo</code> String Descri\u00e7\u00e3o literal do status da resposta. <code>dhResp</code> String Data e hora da mensagem de Resposta. Formato:  \u201cAAAA-MMDDThh:m m:ssTZD\u201d (UTC \u2013 Universal Coordinated) <code>docZip</code> String Informa\u00e7\u00e3o resumida ou documento fiscal eletr\u00f4nico de interesse da ou empresa. O conte\u00fado desta tag estar\u00e1 compactado no padr\u00e3o gZip. O tipo do campo \u00e9 base64Binary. <code>xml</code> String Retorno original da SEFAZ (XML) convertido para String. <pre><code>{\n  \"tpAmb\": \"2\",\n  \"verAplic\": \"SP_NFE_PL009_V4\",\n  \"cStat\": \"102\",\n  \"xMotivo\": \"Inutiliza\u00e7\u00e3o de n\u00famero homologado\",\n  \"cUF\": \"35\",\n  \"ano\": \"24\",\n  \"CNPJ\": \"99999999999999\",\n  \"mod\": \"55\",\n  \"serie\": \"1\",\n  \"nNFIni\": \"999\",\n  \"nNFFin\": \"999\",\n  \"dhRecbto\": \"2024-07-16T18:14:13-03:00\",\n  \"nProt\": \"999999999999999\",\n  \"xml\": \"&lt;?xml version= \\\"1.0\\\" encoding= \\\"utf-8\\\"?&gt; &lt;soap:Envelope xmlns:soap= \\\"http://www.w3.org/2003/05/soap-envelope\\\" xmlns:xsi= \\\"http://www.w3.org/2001/XMLSchema-instance\\\" xmlns:xsd= \\\"http://www.w3.org/2001/XMLSchema\\\"&gt; &lt;soap:Body&gt; &lt;nfeResultMsg xmlns= \\\"http://www.portalfiscal.inf.br/nfe/wsdl/NFeInutilizacao4\\\"&gt; &lt;retInutNFe versao= \\\"4.00\\\" xmlns= \\\"http://www.portalfiscal.inf.br/nfe\\\"&gt; &lt;infInut&gt; &lt;tpAmb&gt;2&lt;/tpAmb&gt; &lt;verAplic&gt;SP_NFE_PL009_V4&lt;/verAplic&gt; &lt;cStat&gt;102&lt;/cStat&gt; &lt;xMotivo&gt;Inutiliza\u00e7\u00e3o de n\u00famero homologado&lt;/xMotivo&gt; &lt;cUF&gt;35&lt;/cUF&gt; &lt;ano&gt;24&lt;/ano&gt; &lt;CNPJ&gt;99999999999999&lt;/CNPJ&gt; &lt;mod&gt;55&lt;/mod&gt; &lt;serie&gt;1&lt;/serie&gt; &lt;nNFIni&gt;999&lt;/nNFIni&gt; &lt;nNFFin&gt;999&lt;/nNFFin&gt; &lt;dhRecbto&gt;2024-07-16T18:14:13-03:00&lt;/dhRecbto&gt; &lt;nProt&gt;999999999999999&lt;/nProt&gt; &lt;/infInut&gt; &lt;/retInutNFe&gt; &lt;/nfeResultMsg&gt; &lt;/soap:Body&gt; &lt;/soap:Envelope&gt;\"\n}\n</code></pre> <p> Para mais informa\u00e7\u00f5es sobre o processo consulte <code>Web Service \u2013 NfeInutilizacao</code>. </p>"},{"location":"nfeRecepcaoEvento/","title":"NFeRecepcaoEvento","text":"<p><code>Fun\u00e7\u00e3o</code>: Servi\u00e7o destinado \u00e0 recep\u00e7\u00e3o de mensagem de Evento da NF-e. <code>Processo</code>: s\u00edncrono. <code>M\u00e9todo</code>: nfeRecepcaoEvento</p> <p></p> <p>O M\u00e9todo NFE_RecepcaoEvento pode receber um objeto que possua at\u00e9 20 eventos e atende qualquer um dos tipos de eventos listados abaixo:</p> <ul> <li><code>210210</code>: Ci\u00eancia da Opera\u00e7\u00e3o.</li> <li><code>210200</code>: Confirma\u00e7\u00e3o da Opera\u00e7\u00e3o.</li> <li><code>110110</code>: Carta de Corre\u00e7\u00e3o.</li> <li><code>110111</code>: Cancelamento.</li> <li><code>210220</code>: Desconhecimento da Opera\u00e7\u00e3o.</li> <li><code>210240</code>: Opera\u00e7\u00e3o N\u00e3o Realizada.</li> <li><code>110140</code>: EPEC (Evento Pr\u00e9vio de Emiss\u00e3o em Conting\u00eancia). </li> </ul> Interface de Entrada Chave Tipo Descri\u00e7\u00e3o <code>cOrgao</code> Number C\u00f3digo do \u00f3rg\u00e3o de recep\u00e7\u00e3o do Evento, conforme Tabela do IBGE ou: 91=Ambiente Nacional. Informar o c\u00f3digo da UF para este evento. <code>tpAmb</code> Number Identifica\u00e7\u00e3o do Ambiente: 1- Produ\u00e7\u00e3o; 2- Homologa\u00e7\u00e3o; <code>CNPJ</code> String CNPJ do autor do evento <code>CPF</code> String CPF do autor do evento <code>chNFe</code> String Chave de Acesso da NF-e \u00e0 qual o evento ser\u00e1 vinculado <code>dhEvento</code> String Data e hora do evento no formato AAAA-MM-DD-Thh:m m:ssTZD (UTC \u2013 Universal Coordinated Time) <code>tpEvento</code> String C\u00f3digo do evento (de acordo com tabelas do item 3.1) <code>nSeqEvento</code> Number Sequencial do evento para o mesmo tipo de evento. <code>verEvento</code> String Vers\u00e3o do grupo de detalhe do evento. <code>descEvento</code> String Informar a descri\u00e7\u00e3o do evento. <code>xCorrecao</code> String Corre\u00e7\u00e3o a ser considerada, texto livre. A corre\u00e7\u00e3o mais recente substitui as anteriores. <code>xCondUso</code> String Condi\u00e7\u00f5es de uso da Carta de Corre\u00e7\u00e3o, informar a literal : \u201cA Carta de Corre\u00e7\u00e3o \u00e9 disciplinada pelo \u00a7 1\u00ba-A do art. 7\u00ba do Conv\u00eanio S/N, de 15 de dezembro de 1970 e pode ser utilizada para regulariza\u00e7\u00e3o de erro ocorrido na emiss\u00e3o de documento fiscal, desde que o erro n\u00e3o esteja relacionado com: I - as vari\u00e1veis que determinam o valor do imposto tais como: base de c\u00e1lculo, al\u00edquota, diferen\u00e7a de pre\u00e7o, quantidade, valor da opera\u00e7\u00e3o ou da presta\u00e7\u00e3o; II - a corre\u00e7\u00e3o de dados cadastrais que implique mudan\u00e7a do remetente ou do destinat\u00e1rio; III - a data de emiss\u00e3o ou de sa\u00edda.\u201d (texto com acentua\u00e7\u00e3o) ou \u201cA Carta de Correcao e disciplinada pelo paragrafo 1o-A do art. 7o do Convenio S/N, de 15 de dezembro de 1970 e pode ser utilizada para regularizacao de erro ocorrido na emissao de documento fiscal, desde que o erro nao esteja relacionado com: I - as variaveis que determinam o valor do imposto tais como: base de calculo, aliquota, diferenca de preco, quantidade, valor da operacao ou da prestacao; II - a correcao de dados cadastrais que implique mudanca do remetente ou do destinatario; III - a data de emissao ou de saida.\u201d (texto sem acentua\u00e7\u00e3o) <code>nProt</code> String Informar o n\u00famero do Protocolo de Autoriza\u00e7\u00e3o da NFe. <code>xJust</code> String Informar a justificativa. <code>cOrgaoAutor</code> Number C\u00f3digo do \u00d3rg\u00e3o do Autor do Evento.Nota: Informar o c\u00f3digo da UF do Emitente para este evento. <code>tpAutor</code> String Informar \"1=Empresa Emitente/Pessoa F\u00edsica\" para este evento.(NT 2018.004) Nota: 1=Empresa Emitente; 2=Empresa Destinat\u00e1ria; 3=Empresa; 5=Fisco; 6=RFB; 9=Outros \u00d3rg\u00e3os. <code>verAplic</code> String VVers\u00e3o do aplicativo do Autor do Evento. <code>dhEmi</code> String Data e hora no formato UTC (Universal Coordinated Time): \"AAAA-MM-DDThh:m m:ss TZD\" <code>tpNF</code> Number 0- Entrada 1- Sa\u00edda <code>IE</code> String Inscri\u00e7\u00e3o Estadual <code>UF</code> String Sigla da UF do destinat\u00e1rio. Informar \u201cEX\u201d no caso de opera\u00e7\u00e3o com o exterior. <code>vNF</code> String Valor total da NF-e. <code>vICMS</code> String Valor total do ICMS. <code>vST</code> String Valor total do ICMS Substitui\u00e7\u00e3o Tribut\u00e1ria."},{"location":"nfeRecepcaoEvento/#nfe_recepcaoevento","title":"<code>NFE_RecepcaoEvento</code>","text":"<p>NFE_RecepcaoEvento<pre><code>import { EventoNFe } from '@Protocols';\n\nconst timeZone = Intl.DateTimeFormat().resolvedOptions().timeZone;\nconst evento: EventoNFe = {\n    idLote: 1,\n    evento: [\n        // O m\u00e9todo aceita at\u00e9 20 eventos por lote\n        {\n            cOrgao: 91,\n            tpAmb: 2,\n            CNPJ: '99999999999999',\n            chNFe: '99999999999999999999999999999999999999999999',\n            dhEvento: format(new Date(), \"yyyy-MM-dd'T'HH:mm:ssXXX\", { timeZone }),\n            tpEvento: '210210',\n            nSeqEvento: 1,\n            verEvento: '1.00',\n            detEvento: {\n                descEvento: 'Ciencia da Operacao',\n            }\n        },\n        {\n            tpAmb: 2,\n            cOrgao: 91,\n            CNPJ: '99999999999999',\n            chNFe: '99999999999999999999999999999999999999999999',\n            dhEvento: format(new Date(), \"yyyy-MM-dd'T'HH:mm:ssXXX\", { timeZone }),\n            tpEvento: '210200',\n            nSeqEvento: 1,\n            verEvento: '1.00',\n            detEvento: {\n                descEvento: 'Confirmacao da Operacao',\n            }\n        },\n        {\n            cOrgao: 35,\n            tpAmb: 2,\n            CNPJ: '99999999999999',\n            chNFe: '99999999999999999999999999999999999999999999',\n            dhEvento: format(new Date(), \"yyyy-MM-dd'T'HH:mm:ssXXX\", { timeZone }),\n            tpEvento: '110110',\n            nSeqEvento: 1,\n            verEvento: '1.00',\n            detEvento: {\n                descEvento: 'Carta de Corre\u00e7\u00e3o',\n                xCorrecao: 'Teste de homologa\u00e7\u00e3o',\n                xCondUso: 'A Carta de Correcao e disciplinada pelo paragrafo 1o-A do art. 7o do Convenio S/N, de 15 de dezembro de 1970 e pode ser utilizada para regularizacao de erro ocorrido na emissao de documento fiscal, desde que o erro nao esteja relacionado com: I - as variaveis que determinam o valor do imposto tais como: base de calculo, aliquota, diferenca de preco, quantidade, valor da operacao ou da prestacao; II - a correcao de dados cadastrais que implique mudanca do remetente ou do destinatario; III - a data de emissao ou de saida.',\n            }\n        },\n        {\n            tpAmb: 2,\n            cOrgao: 35,\n            CNPJ: '99999999999999',\n            chNFe: '99999999999999999999999999999999999999999999',\n            dhEvento: format(new Date(), \"yyyy-MM-dd'T'HH:mm:ssXXX\", { timeZone }),\n            tpEvento: '110111',\n            nSeqEvento: 1,\n            verEvento: '1.00',\n            detEvento: {\n                descEvento: 'Cancelamento',\n                nProt: '999999999999999',\n                xJust: 'Cancelamento homologacao',\n            }\n        },\n        {\n            cOrgao: 91,\n            tpAmb: 2,\n            CNPJ: '99999999999999',\n            chNFe: '99999999999999999999999999999999999999999999',\n            dhEvento: format(new Date(), \"yyyy-MM-dd'T'HH:mm:ssXXX\", { timeZone }),\n            tpEvento: '210220',\n            nSeqEvento: 1,\n            verEvento: '1.00',\n            detEvento: {\n                descEvento: 'Desconhecimento da Operacao',\n            }\n        },\n        {\n            cOrgao: 91,\n            tpAmb: 2,\n            CNPJ: '99999999999999',\n            chNFe: '99999999999999999999999999999999999999999999',\n            dhEvento: format(new Date(), \"yyyy-MM-dd'T'HH:mm:ssXXX\", { timeZone }),\n            tpEvento: '210240',\n            nSeqEvento: 1,\n            verEvento: '1.00',\n            detEvento: {\n                descEvento: 'Operacao nao Realizada',\n                xJust: 'Teste Operacao nao Realizada em homologa\u00e7\u00e3o'\n            }\n        },\n        {\n            tpAmb: 2,\n            cOrgao: 91,\n            CNPJ: '99999999999999',\n            chNFe: '99999999999999999999999999999999999999999999',\n            dhEvento: format(new Date(), \"yyyy-MM-dd'T'HH:mm:ssXXX\", { timeZone }),\n            tpEvento: '110140',\n            nSeqEvento: 1,\n            verEvento: '1.00',\n            detEvento: {\n                descEvento: 'EPEC',\n                cOrgaoAutor: 35,\n                tpAutor: 1,\n                verAplic: '1.00',\n                dhEmi: '2024-07-10T09:38:55-03:00',\n                tpNF: 1,\n                IE: '999999999999',\n                dest: {\n                    UF: 'SP',\n                    CNPJ: '99999999999999',\n                    IE: '999999999999',\n                    vNF: '999.99',\n                    vICMS: '999.99',\n                    vST: '999.99',\n                }\n            }\n        }\n\n    ]\n}\n\nawait nfewizard.NFE_RecepcaoEvento(evento);\n</code></pre>  Tamb\u00e9m \u00e9 poss\u00edvel utilizar o m\u00e9todo especifico para cada tipo de evento: </p>"},{"location":"nfeRecepcaoEvento/#nfe_cienciadaoperacao","title":"<code>NFE_CienciaDaOperacao</code>","text":"NFE_CienciaDaOperacao<pre><code>import { CienciaDaOperacao } from '@Protocols';\n\nconst timeZone = Intl.DateTimeFormat().resolvedOptions().timeZone;\nconst cienciaDaOperacao: CienciaDaOperacao = {\n    idLote: 1,\n    evento: [\n        {\n            cOrgao: 91,\n            tpAmb: 2,\n            CNPJ: '99999999999999',\n            chNFe: '99999999999999999999999999999999999999999999',\n            dhEvento: format(new Date(), \"yyyy-MM-dd'T'HH:mm:ssXXX\", { timeZone }),\n            tpEvento: '210210',\n            nSeqEvento: 1,\n            verEvento: '1.00',\n            detEvento: {\n                descEvento: 'Ciencia da Operacao',\n            }\n        }\n    ]\n}\n\nawait nfewizard.NFE_CienciaDaOperacao(cienciaDaOperacao);\n</code></pre> <p><code>Retorno</code>:</p> Interface de Retorno Chave Tipo Descri\u00e7\u00e3o <code>idLote</code> Number Identificador de controle do Lote de envio do Evento. <code>tpAmb</code> Number Identifica\u00e7\u00e3o do Ambiente: 1- Produ\u00e7\u00e3o; 2- Homologa\u00e7\u00e3o. <code>verAplic</code> String Vers\u00e3o da aplica\u00e7\u00e3o que processou o evento. <code>cOrgao</code> Number \u00d3rg\u00e3o de recep\u00e7\u00e3o do Evento, idem a mensagem de entrada. <code>cStat</code> Number C\u00f3digo do status da resposta. <code>xMotivo</code> String Descri\u00e7\u00e3o do status da resposta. <code>chNFe</code> String Chave de Acesso da NF-e \u00e0 qual o evento foi vinculado <code>tpEvento</code> String C\u00f3digo do evento. <code>xEvento</code> String Descri\u00e7\u00e3o do evento. <code>nSeqEvento</code> Number Sequencial do evento para o mesmo tipo de evento. <code>CNPJDest</code> Number CNPJ do destinat\u00e1rio da NF-e. <code>dhRegEvento</code> String Data e hora do registro do evento no formato AAAAMMDDThh:m m:ssTZD (UTC \u2013 Universal Coordinated Time).Se o evento for rejeitado informar a data e hora de recebimento do evento. <code>nProt</code> Number N\u00famero do Protocolo do Evento. <code>xml</code> String Retorno original da SEFAZ (XML) convertido para String. <pre><code>[\n  {\n    \"idLote\": \"1\",\n    \"tpAmb\": \"2\",\n    \"verAplic\": \"AN_1.8.4\",\n    \"cOrgao\": \"91\",\n    \"cStat\": \"128\",\n    \"xMotivo\": \"Lote de evento processado\",\n    \"retEvento\": {\n      \"infEvento\": {\n        \"tpAmb\": \"2\",\n        \"verAplic\": \"AN_1.8.4\",\n        \"cOrgao\": \"91\",\n        \"cStat\": \"135\",\n        \"xMotivo\": \"Evento registrado e vinculado a NF-e\",\n        \"chNFe\": \"99999999999999999999999999999999999999999999\",\n        \"tpEvento\": \"210210\",\n        \"xEvento\": \"Ciencia da Operacao\",\n        \"nSeqEvento\": \"1\",\n        \"CNPJDest\": \"99999999999999\",\n        \"dhRegEvento\": \"2024-07-17T15:32:48-03:00\",\n        \"nProt\": \"999999999999999\"\n      }\n    },\n    \"xml\": \"&lt;?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?&gt;&lt;soap:Envelope xmlns:soap=\\\"http://www.w3.org/2003/05/soap-envelope\\\" xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xmlns:xsd=\\\"http://www.w3.org/2001/XMLSchema\\\"&gt;&lt;soap:Body&gt;&lt;nfeRecepcaoEventoNFResult xmlns=\\\"http://www.portalfiscal.inf.br/nfe/wsdl/NFeRecepcaoEvento4\\\"&gt;&lt;retEnvEvento versao=\\\"1.00\\\" xmlns=\\\"http://www.portalfiscal.inf.br/nfe\\\"&gt;&lt;idLote&gt;1&lt;/idLote&gt;&lt;tpAmb&gt;2&lt;/tpAmb&gt;&lt;verAplic&gt;AN_1.8.4&lt;/verAplic&gt;&lt;cOrgao&gt;91&lt;/cOrgao&gt;&lt;cStat&gt;128&lt;/cStat&gt;&lt;xMotivo&gt;Lote de evento processado&lt;/xMotivo&gt;&lt;retEvento versao=\\\"1.00\\\"&gt;&lt;infEvento&gt;&lt;tpAmb&gt;2&lt;/tpAmb&gt;&lt;verAplic&gt;AN_1.8.4&lt;/verAplic&gt;&lt;cOrgao&gt;91&lt;/cOrgao&gt;&lt;cStat&gt;573&lt;/cStat&gt;&lt;xMotivo&gt;Rejeicao: Duplicidade de evento&lt;/xMotivo&gt;&lt;chNFe&gt;99999999999999999999999999999999999999999999&lt;/chNFe&gt;&lt;tpEvento&gt;210210&lt;/tpEvento&gt;&lt;xEvento&gt;Ciencia da Operacao&lt;/xEvento&gt;&lt;nSeqEvento&gt;1&lt;/nSeqEvento&gt;&lt;dhRegEvento&gt;2024-07-17T15:32:48-03:00&lt;/dhRegEvento&gt;&lt;/infEvento&gt;&lt;/retEvento&gt;&lt;/retEnvEvento&gt;&lt;/nfeRecepcaoEventoNFResult&gt;&lt;/soap:Body&gt;&lt;/soap:Envelope&gt;\"\n  }\n]\n</code></pre> <p></p>"},{"location":"nfeRecepcaoEvento/#nfe_confirmacaodaoperacao","title":"<code>NFE_ConfirmacaoDaOperacao</code>","text":"NFE_ConfirmacaoDaOperacao<pre><code>import { ConfirmacaoDaOperacao } from '@Protocols';\n\nconst timeZone = Intl.DateTimeFormat().resolvedOptions().timeZone;\nconst confirmacaoDaOperacao: ConfirmacaoDaOperacao = {\n    idLote: 1,\n    evento: [\n        {\n            tpAmb: 2,\n            cOrgao: 91,\n            CNPJ: '99999999999999',\n            chNFe: '99999999999999999999999999999999999999999999',\n            dhEvento: format(new Date(), \"yyyy-MM-dd'T'HH:mm:ssXXX\", { timeZone }),\n            tpEvento: '210200',\n            nSeqEvento: 1,\n            verEvento: '1.00',\n            detEvento: {\n                descEvento: 'Confirmacao da Operacao',\n            }\n        }\n    ]\n}\n\nawait nfewizard.NFE_ConfirmacaoDaOperacao(confirmacaoDaOperacao);\n</code></pre> <p><code>Retorno</code>:</p> Interface de Retorno Chave Tipo Descri\u00e7\u00e3o <code>idLote</code> Number Identificador de controle do Lote de envio do Evento. <code>tpAmb</code> Number Identifica\u00e7\u00e3o do Ambiente: 1- Produ\u00e7\u00e3o; 2- Homologa\u00e7\u00e3o. <code>verAplic</code> String Vers\u00e3o da aplica\u00e7\u00e3o que processou o evento. <code>cOrgao</code> Number \u00d3rg\u00e3o de recep\u00e7\u00e3o do Evento, idem a mensagem de entrada. <code>cStat</code> Number C\u00f3digo do status da resposta. <code>xMotivo</code> String Descri\u00e7\u00e3o do status da resposta. <code>chNFe</code> String Chave de Acesso da NF-e \u00e0 qual o evento foi vinculado <code>tpEvento</code> String C\u00f3digo do evento. <code>xEvento</code> String Descri\u00e7\u00e3o do evento. <code>nSeqEvento</code> Number Sequencial do evento para o mesmo tipo de evento. <code>CNPJDest</code> Number CNPJ do destinat\u00e1rio da NF-e. <code>dhRegEvento</code> String Data e hora do registro do evento no formato AAAAMMDDThh:m m:ssTZD (UTC \u2013 Universal Coordinated Time).Se o evento for rejeitado informar a data e hora de recebimento do evento. <code>nProt</code> Number N\u00famero do Protocolo do Evento. <code>xml</code> String Retorno original da SEFAZ (XML) convertido para String. <pre><code>[\n  {\n    \"idLote\": \"1\",\n    \"tpAmb\": \"2\",\n    \"verAplic\": \"AN_1.8.4\",\n    \"cOrgao\": \"91\",\n    \"cStat\": \"128\",\n    \"xMotivo\": \"Lote de evento processado\",\n    \"retEvento\": {\n      \"infEvento\": {\n        \"tpAmb\": \"2\",\n        \"verAplic\": \"AN_1.8.4\",\n        \"cOrgao\": \"91\",\n        \"cStat\": \"135\",\n        \"xMotivo\": \"Evento registrado e vinculado a NF-e\",\n        \"chNFe\": \"99999999999999999999999999999999999999999999\",\n        \"tpEvento\": \"210200\",\n        \"xEvento\": \"Confirmacao da Operacao\",\n        \"nSeqEvento\": \"1\",\n        \"CNPJDest\": \"99999999999999\",\n        \"dhRegEvento\": \"2024-07-17T15:48:45-03:00\",\n        \"nProt\": \"999999999999999\"\n      }\n    },\n    \"xml\": \"&lt;?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?&gt;&lt;soap:Envelope xmlns:soap=\\\"http://www.w3.org/2003/05/soap-envelope\\\" xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xmlns:xsd=\\\"http://www.w3.org/2001/XMLSchema\\\"&gt;&lt;soap:Body&gt;&lt;nfeRecepcaoEventoNFResult xmlns=\\\"http://www.portalfiscal.inf.br/nfe/wsdl/NFeRecepcaoEvento4\\\"&gt;&lt;retEnvEvento versao=\\\"1.00\\\" xmlns=\\\"http://www.portalfiscal.inf.br/nfe\\\"&gt;&lt;idLote&gt;1&lt;/idLote&gt;&lt;tpAmb&gt;2&lt;/tpAmb&gt;&lt;verAplic&gt;AN_1.8.4&lt;/verAplic&gt;&lt;cOrgao&gt;91&lt;/cOrgao&gt;&lt;cStat&gt;128&lt;/cStat&gt;&lt;xMotivo&gt;Lote de evento processado&lt;/xMotivo&gt;&lt;retEvento versao=\\\"1.00\\\"&gt;&lt;infEvento Id=\\\"ID999999999999999\\\" xmlns=\\\"http://www.portalfiscal.inf.br/nfe\\\"&gt;&lt;tpAmb&gt;2&lt;/tpAmb&gt;&lt;verAplic&gt;AN_1.8.4&lt;/verAplic&gt;&lt;cOrgao&gt;91&lt;/cOrgao&gt;&lt;cStat&gt;136&lt;/cStat&gt;&lt;xMotivo&gt;Evento registrado, mas nao vinculado a NF-e&lt;/xMotivo&gt;&lt;chNFe&gt;99999999999999999999999999999999999999999999&lt;/chNFe&gt;&lt;tpEvento&gt;210200&lt;/tpEvento&gt;&lt;xEvento&gt;Confirmacao da Operacao&lt;/xEvento&gt;&lt;nSeqEvento&gt;1&lt;/nSeqEvento&gt;&lt;CNPJDest&gt;99999999999999&lt;/CNPJDest&gt;&lt;dhRegEvento&gt;2024-07-17T15:48:45-03:00&lt;/dhRegEvento&gt;&lt;nProt&gt;999999999999999&lt;/nProt&gt;&lt;/infEvento&gt;&lt;/retEvento&gt;&lt;/retEnvEvento&gt;&lt;/nfeRecepcaoEventoNFResult&gt;&lt;/soap:Body&gt;&lt;/soap:Envelope&gt;\"\n  }\n]\n</code></pre> <p></p>"},{"location":"nfeRecepcaoEvento/#nfe_cartadecorrecao","title":"<code>NFE_CartaDeCorrecao</code>","text":"NFE_CartaDeCorrecao<pre><code>import { CartaDeCorrecao } from '@Protocols';\n\nconst timeZone = Intl.DateTimeFormat().resolvedOptions().timeZone;\nconst cartaDeCorrecao: CartaDeCorrecao = {\n    idLote: 1,\n    evento: [\n        {\n            cOrgao: 35,\n            tpAmb: 2,\n            CNPJ: '99999999999999',\n            chNFe: '99999999999999999999999999999999999999999999',\n            dhEvento: format(new Date(), \"yyyy-MM-dd'T'HH:mm:ssXXX\", { timeZone }),\n            tpEvento: '110110',\n            nSeqEvento: 1,\n            verEvento: '1.00',\n            detEvento: {\n                descEvento: 'Carta de Corre\u00e7\u00e3o',\n                xCorrecao: 'Teste de homologa\u00e7\u00e3o',\n                xCondUso: 'A Carta de Correcao e disciplinada pelo paragrafo 1o-A do art. 7o do Convenio S/N, de 15 de dezembro de 1970 e pode ser utilizada para regularizacao de erro ocorrido na emissao de documento fiscal, desde que o erro nao esteja relacionado com: I - as variaveis que determinam o valor do imposto tais como: base de calculo, aliquota, diferenca de preco, quantidade, valor da operacao ou da prestacao; II - a correcao de dados cadastrais que implique mudanca do remetente ou do destinatario; III - a data de emissao ou de saida.',\n            }\n        }\n    ]\n}\n\nawait nfewizard.NFE_CartaDeCorrecao(cartaDeCorrecao);\n</code></pre> <p><code>Retorno</code>:</p> Interface de Retorno Chave Tipo Descri\u00e7\u00e3o <code>idLote</code> Number Identificador de controle do Lote de envio do Evento. <code>tpAmb</code> Number Identifica\u00e7\u00e3o do Ambiente: 1- Produ\u00e7\u00e3o; 2- Homologa\u00e7\u00e3o. <code>verAplic</code> String Vers\u00e3o da aplica\u00e7\u00e3o que processou o evento. <code>cOrgao</code> Number \u00d3rg\u00e3o de recep\u00e7\u00e3o do Evento, idem a mensagem de entrada. <code>cStat</code> Number C\u00f3digo do status da resposta. <code>xMotivo</code> String Descri\u00e7\u00e3o do status da resposta. <code>chNFe</code> String Chave de Acesso da NF-e \u00e0 qual o evento foi vinculado <code>tpEvento</code> String C\u00f3digo do evento. <code>xEvento</code> String Descri\u00e7\u00e3o do evento. <code>nSeqEvento</code> Number Sequencial do evento para o mesmo tipo de evento. <code>CNPJDest</code> Number CNPJ do destinat\u00e1rio da NF-e. <code>dhRegEvento</code> String Data e hora do registro do evento no formato AAAAMMDDThh:m m:ssTZD (UTC \u2013 Universal Coordinated Time).Se o evento for rejeitado informar a data e hora de recebimento do evento. <code>nProt</code> Number N\u00famero do Protocolo do Evento. <code>xml</code> String Retorno original da SEFAZ (XML) convertido para String. <pre><code>[\n  {\n    \"idLote\": \"1\",\n    \"tpAmb\": \"2\",\n    \"verAplic\": \"SP_EVENTOS_PL_100\",\n    \"cOrgao\": \"35\",\n    \"cStat\": \"128\",\n    \"xMotivo\": \"Lote de Evento Processado\",\n    \"retEvento\": {\n      \"infEvento\": {\n        \"tpAmb\": \"2\",\n        \"verAplic\": \"SP_EVENTOS_PL_100\",\n        \"cOrgao\": \"35\",\n        \"cStat\": \"135\",\n        \"xMotivo\": \"Evento registrado e vinculado a NF-e\",\n        \"chNFe\": \"99999999999999999999999999999999999999999999\",\n        \"tpEvento\": \"110110\",\n        \"xEvento\": \"Carta de Corre\u00e7\u00e3o registrada\",\n        \"nSeqEvento\": \"1\",\n        \"CNPJDest\": \"99999999999999\",\n        \"dhRegEvento\": \"2024-07-17T15:58:10-03:00\",\n        \"nProt\": \"999999999999999\"\n      }\n    },\n    \"xml\": \"&lt;?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?&gt;&lt;soap:Envelope xmlns:soap=\\\"http://www.w3.org/2003/05/soap-envelope\\\" xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xmlns:xsd=\\\"http://www.w3.org/2001/XMLSchema\\\"&gt;&lt;soap:Body&gt;&lt;nfeResultMsg xmlns=\\\"http://www.portalfiscal.inf.br/nfe/wsdl/NFeRecepcaoEvento4\\\"&gt;&lt;retEnvEvento versao=\\\"1.00\\\" xmlns=\\\"http://www.portalfiscal.inf.br/nfe\\\"&gt;&lt;idLote&gt;1&lt;/idLote&gt;&lt;tpAmb&gt;2&lt;/tpAmb&gt;&lt;verAplic&gt;SP_EVENTOS_PL_100&lt;/verAplic&gt;&lt;cOrgao&gt;35&lt;/cOrgao&gt;&lt;cStat&gt;128&lt;/cStat&gt;&lt;xMotivo&gt;Lote de Evento Processado&lt;/xMotivo&gt;&lt;retEvento versao=\\\"1.00\\\"&gt;&lt;infEvento&gt;&lt;tpAmb&gt;2&lt;/tpAmb&gt;&lt;verAplic&gt;SP_EVENTOS_PL_100&lt;/verAplic&gt;&lt;cOrgao&gt;35&lt;/cOrgao&gt;&lt;cStat&gt;135&lt;/cStat&gt;&lt;xMotivo&gt;Evento registrado e vinculado a NF-e&lt;/xMotivo&gt;&lt;chNFe&gt;99999999999999999999999999999999999999999999&lt;/chNFe&gt;&lt;tpEvento&gt;110110&lt;/tpEvento&gt;&lt;xEvento&gt;Carta de Corre\u00e7\u00e3o registrada&lt;/xEvento&gt;&lt;nSeqEvento&gt;1&lt;/nSeqEvento&gt;&lt;CNPJDest&gt;99999999999999&lt;/CNPJDest&gt;&lt;dhRegEvento&gt;2024-07-17T15:58:10-03:00&lt;/dhRegEvento&gt;&lt;nProt&gt;999999999999999&lt;/nProt&gt;&lt;/infEvento&gt;&lt;/retEvento&gt;&lt;/retEnvEvento&gt;&lt;/nfeResultMsg&gt;&lt;/soap:Body&gt;&lt;/soap:Envelope&gt;\"\n  }\n]\n</code></pre> <p></p>"},{"location":"nfeRecepcaoEvento/#nfe_cancelamento","title":"<code>NFE_Cancelamento</code>","text":"NFE_Cancelamento<pre><code>import { Cancelamento } from '@Protocols';\n\nconst timeZone = Intl.DateTimeFormat().resolvedOptions().timeZone;\nconst cancelamento: Cancelamento = {\n    idLote: 1,\n    evento: [\n        {\n            tpAmb: 2,\n            cOrgao: 35,\n            CNPJ: '99999999999999',\n            chNFe: '99999999999999999999999999999999999999999999',\n            dhEvento: format(new Date(), \"yyyy-MM-dd'T'HH:mm:ssXXX\", { timeZone }),\n            tpEvento: '110111',\n            nSeqEvento: 1,\n            verEvento: '1.00',\n            detEvento: {\n                descEvento: 'Cancelamento',\n                nProt: '999999999999999',\n                xJust: 'Cancelamento homologacao',\n            }\n        }\n    ]\n}\n\nawait nfewizard.NFE_Cancelamento(cancelamento);\n</code></pre> <p><code>Retorno</code>:</p> Interface de Retorno Chave Tipo Descri\u00e7\u00e3o <code>idLote</code> Number Identificador de controle do Lote de envio do Evento. <code>tpAmb</code> Number Identifica\u00e7\u00e3o do Ambiente: 1- Produ\u00e7\u00e3o; 2- Homologa\u00e7\u00e3o. <code>verAplic</code> String Vers\u00e3o da aplica\u00e7\u00e3o que processou o evento. <code>cOrgao</code> Number \u00d3rg\u00e3o de recep\u00e7\u00e3o do Evento, idem a mensagem de entrada. <code>cStat</code> Number C\u00f3digo do status da resposta. <code>xMotivo</code> String Descri\u00e7\u00e3o do status da resposta. <code>chNFe</code> String Chave de Acesso da NF-e \u00e0 qual o evento foi vinculado <code>tpEvento</code> String C\u00f3digo do evento. <code>xEvento</code> String Descri\u00e7\u00e3o do evento. <code>nSeqEvento</code> Number Sequencial do evento para o mesmo tipo de evento. <code>CNPJDest</code> Number CNPJ do destinat\u00e1rio da NF-e. <code>dhRegEvento</code> String Data e hora do registro do evento no formato AAAAMMDDThh:m m:ssTZD (UTC \u2013 Universal Coordinated Time).Se o evento for rejeitado informar a data e hora de recebimento do evento. <code>nProt</code> Number N\u00famero do Protocolo do Evento. <code>xml</code> String Retorno original da SEFAZ (XML) convertido para String. <pre><code>[\n  {\n    \"idLote\": \"1\",\n    \"tpAmb\": \"2\",\n    \"verAplic\": \"SP_EVENTOS_PL_100\",\n    \"cOrgao\": \"35\",\n    \"cStat\": \"128\",\n    \"xMotivo\": \"Lote de Evento Processado\",\n    \"retEvento\": {\n      \"infEvento\": {\n        \"tpAmb\": \"2\",\n        \"verAplic\": \"SP_EVENTOS_PL_100\",\n        \"cOrgao\": \"35\",\n        \"cStat\": \"135\",\n        \"xMotivo\": \"Evento registrado e vinculado a NF-e\",\n        \"chNFe\": \"99999999999999999999999999999999999999999999\",\n        \"tpEvento\": \"110111\",\n        \"xEvento\": \"Cancelamento registrado\",\n        \"nSeqEvento\": \"1\",\n        \"CNPJDest\": \"99999999999999\",\n        \"dhRegEvento\": \"2024-07-17T17:37:52-03:00\",\n        \"nProt\": \"999999999999999\"\n      }\n    },\n    \"xml\": \"&lt;?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?&gt;&lt;soap:Envelope xmlns:soap=\\\"http://www.w3.org/2003/05/soap-envelope\\\" xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xmlns:xsd=\\\"http://www.w3.org/2001/XMLSchema\\\"&gt;&lt;soap:Body&gt;&lt;nfeResultMsg xmlns=\\\"http://www.portalfiscal.inf.br/nfe/wsdl/NFeRecepcaoEvento4\\\"&gt;&lt;retEnvEvento versao=\\\"1.00\\\" xmlns=\\\"http://www.portalfiscal.inf.br/nfe\\\"&gt;&lt;idLote&gt;1&lt;/idLote&gt;&lt;tpAmb&gt;2&lt;/tpAmb&gt;&lt;verAplic&gt;SP_EVENTOS_PL_100&lt;/verAplic&gt;&lt;cOrgao&gt;35&lt;/cOrgao&gt;&lt;cStat&gt;128&lt;/cStat&gt;&lt;xMotivo&gt;Lote de Evento Processado&lt;/xMotivo&gt;&lt;retEvento versao=\\\"1.00\\\"&gt;&lt;infEvento&gt;&lt;tpAmb&gt;2&lt;/tpAmb&gt;&lt;verAplic&gt;SP_EVENTOS_PL_100&lt;/verAplic&gt;&lt;cOrgao&gt;35&lt;/cOrgao&gt;&lt;cStat&gt;135&lt;/cStat&gt;&lt;xMotivo&gt;Evento registrado e vinculado a NF-e&lt;/xMotivo&gt;&lt;chNFe&gt;99999999999999999999999999999999999999999999&lt;/chNFe&gt;&lt;tpEvento&gt;110111&lt;/tpEvento&gt;&lt;xEvento&gt;Cancelamento registrado&lt;/xEvento&gt;&lt;nSeqEvento&gt;1&lt;/nSeqEvento&gt;&lt;CNPJDest&gt;99999999999999&lt;/CNPJDest&gt;&lt;dhRegEvento&gt;2024-07-17T17:37:52-03:00&lt;/dhRegEvento&gt;&lt;nProt&gt;999999999999999&lt;/nProt&gt;&lt;/infEvento&gt;&lt;/retEvento&gt;&lt;/retEnvEvento&gt;&lt;/nfeResultMsg&gt;&lt;/soap:Body&gt;&lt;/soap:Envelope&gt;\"\n  }\n]\n</code></pre> <p></p>"},{"location":"nfeRecepcaoEvento/#nfe_desconhecimentodaoperacao","title":"<code>NFE_DesconhecimentoDaOperacao</code>","text":"NFE_DesconhecimentoDaOperacao<pre><code>import { DesconhecimentoDaOperacao } from '@Protocols';\n\nconst timeZone = Intl.DateTimeFormat().resolvedOptions().timeZone;\nconst desconhecimentoDaOperacao: DesconhecimentoDaOperacao = {\n    idLote: 1,\n    evento: [\n        {\n            cOrgao: 91,\n            tpAmb: 2,\n            CNPJ: '99999999999999',\n            chNFe: '99999999999999999999999999999999999999999999',\n            dhEvento: format(new Date(), \"yyyy-MM-dd'T'HH:mm:ssXXX\", { timeZone }),\n            tpEvento: '210220',\n            nSeqEvento: 1,\n            verEvento: '1.00',\n            detEvento: {\n                descEvento: 'Desconhecimento da Operacao',\n            }\n        }\n    ]\n}\n\nawait nfewizard.NFE_DesconhecimentoDaOperacao(desconhecimentoDaOperacao);\n</code></pre> <p><code>Retorno</code>:</p> Interface de Retorno Chave Tipo Descri\u00e7\u00e3o <code>idLote</code> Number Identificador de controle do Lote de envio do Evento. <code>tpAmb</code> Number Identifica\u00e7\u00e3o do Ambiente: 1- Produ\u00e7\u00e3o; 2- Homologa\u00e7\u00e3o. <code>verAplic</code> String Vers\u00e3o da aplica\u00e7\u00e3o que processou o evento. <code>cOrgao</code> Number \u00d3rg\u00e3o de recep\u00e7\u00e3o do Evento, idem a mensagem de entrada. <code>cStat</code> Number C\u00f3digo do status da resposta. <code>xMotivo</code> String Descri\u00e7\u00e3o do status da resposta. <code>chNFe</code> String Chave de Acesso da NF-e \u00e0 qual o evento foi vinculado <code>tpEvento</code> String C\u00f3digo do evento. <code>xEvento</code> String Descri\u00e7\u00e3o do evento. <code>nSeqEvento</code> Number Sequencial do evento para o mesmo tipo de evento. <code>CNPJDest</code> Number CNPJ do destinat\u00e1rio da NF-e. <code>dhRegEvento</code> String Data e hora do registro do evento no formato AAAAMMDDThh:m m:ssTZD (UTC \u2013 Universal Coordinated Time).Se o evento for rejeitado informar a data e hora de recebimento do evento. <code>nProt</code> Number N\u00famero do Protocolo do Evento. <code>xml</code> String Retorno original da SEFAZ (XML) convertido para String. <pre><code>[\n  {\n    \"idLote\": \"1\",\n    \"tpAmb\": \"2\",\n    \"verAplic\": \"AN_1.8.4\",\n    \"cOrgao\": \"91\",\n    \"cStat\": \"128\",\n    \"xMotivo\": \"Lote de evento processado\",\n    \"retEvento\": {\n      \"infEvento\": {\n        \"tpAmb\": \"2\",\n        \"verAplic\": \"AN_1.8.4\",\n        \"cOrgao\": \"91\",\n        \"cStat\": \"135\",\n        \"xMotivo\": \"Evento registrado e vinculado a NF-e\",\n        \"chNFe\": \"99999999999999999999999999999999999999999999\",\n        \"tpEvento\": \"210220\",\n        \"xEvento\": \"Desconhecimento da Operacao\",\n        \"nSeqEvento\": \"1\",\n        \"CNPJDest\": \"99999999999999\",\n        \"dhRegEvento\": \"2024-07-17T17:23:39-03:00\",\n        \"nProt\": \"999999999999999\"\n      }\n    },\n    \"xml\": \"&lt;?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?&gt;&lt;soap:Envelope xmlns:soap=\\\"http://www.w3.org/2003/05/soap-envelope\\\" xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xmlns:xsd=\\\"http://www.w3.org/2001/XMLSchema\\\"&gt;&lt;soap:Body&gt;&lt;nfeRecepcaoEventoNFResult xmlns=\\\"http://www.portalfiscal.inf.br/nfe/wsdl/NFeRecepcaoEvento4\\\"&gt;&lt;retEnvEvento versao=\\\"1.00\\\" xmlns=\\\"http://www.portalfiscal.inf.br/nfe\\\"&gt;&lt;idLote&gt;1&lt;/idLote&gt;&lt;tpAmb&gt;2&lt;/tpAmb&gt;&lt;verAplic&gt;AN_1.8.4&lt;/verAplic&gt;&lt;cOrgao&gt;91&lt;/cOrgao&gt;&lt;cStat&gt;128&lt;/cStat&gt;&lt;xMotivo&gt;Lote de evento processado&lt;/xMotivo&gt;&lt;retEvento versao=\\\"1.00\\\"&gt;&lt;infEvento Id=\\\"ID891240002367854\\\" xmlns=\\\"http://www.portalfiscal.inf.br/nfe\\\"&gt;&lt;tpAmb&gt;2&lt;/tpAmb&gt;&lt;verAplic&gt;AN_1.8.4&lt;/verAplic&gt;&lt;cOrgao&gt;91&lt;/cOrgao&gt;&lt;cStat&gt;135&lt;/cStat&gt;&lt;xMotivo&gt;Evento registrado e vinculado a NF-e&lt;/xMotivo&gt;&lt;chNFe&gt;99999999999999999999999999999999999999999999&lt;/chNFe&gt;&lt;tpEvento&gt;210220&lt;/tpEvento&gt;&lt;xEvento&gt;Desconhecimento da Operacao&lt;/xEvento&gt;&lt;nSeqEvento&gt;1&lt;/nSeqEvento&gt;&lt;CNPJDest&gt;99999999999999&lt;/CNPJDest&gt;&lt;dhRegEvento&gt;2024-07-17T17:23:39-03:00&lt;/dhRegEvento&gt;&lt;nProt&gt;891240002367854&lt;/nProt&gt;&lt;/infEvento&gt;&lt;/retEvento&gt;&lt;/retEnvEvento&gt;&lt;/nfeRecepcaoEventoNFResult&gt;&lt;/soap:Body&gt;&lt;/soap:Envelope&gt;\"\n  }\n]\n</code></pre> <p></p>"},{"location":"nfeRecepcaoEvento/#nfe_operacaonaorealizada","title":"<code>NFE_OperacaoNaoRealizada</code>","text":"NFE_OperacaoNaoRealizada<pre><code>import { OperacaoNaoRealizada } from '@Protocols';\n\nconst timeZone = Intl.DateTimeFormat().resolvedOptions().timeZone;\nconst operacaoNaoRealizada: OperacaoNaoRealizada = {\n    idLote: 1,\n    evento: [\n        {\n            cOrgao: 91,\n            tpAmb: 2,\n            CNPJ: '99999999999999',\n            chNFe: '99999999999999999999999999999999999999999999',\n            dhEvento: format(new Date(), \"yyyy-MM-dd'T'HH:mm:ssXXX\", { timeZone }),\n            tpEvento: '210240',\n            nSeqEvento: 1,\n            verEvento: '1.00',\n            detEvento: {\n                descEvento: 'Operacao nao Realizada',\n                xJust: 'Teste Operacao nao Realizada em homologa\u00e7\u00e3o'\n            }\n        }\n    ]\n}\n\nawait nfewizard.NFE_OperacaoNaoRealizada(operacaoNaoRealizada);\n</code></pre> <p><code>Retorno</code>:</p> Interface de Retorno Chave Tipo Descri\u00e7\u00e3o <code>idLote</code> Number Identificador de controle do Lote de envio do Evento. <code>tpAmb</code> Number Identifica\u00e7\u00e3o do Ambiente: 1- Produ\u00e7\u00e3o; 2- Homologa\u00e7\u00e3o. <code>verAplic</code> String Vers\u00e3o da aplica\u00e7\u00e3o que processou o evento. <code>cOrgao</code> Number \u00d3rg\u00e3o de recep\u00e7\u00e3o do Evento, idem a mensagem de entrada. <code>cStat</code> Number C\u00f3digo do status da resposta. <code>xMotivo</code> String Descri\u00e7\u00e3o do status da resposta. <code>chNFe</code> String Chave de Acesso da NF-e \u00e0 qual o evento foi vinculado <code>tpEvento</code> String C\u00f3digo do evento. <code>xEvento</code> String Descri\u00e7\u00e3o do evento. <code>nSeqEvento</code> Number Sequencial do evento para o mesmo tipo de evento. <code>CNPJDest</code> Number CNPJ do destinat\u00e1rio da NF-e. <code>dhRegEvento</code> String Data e hora do registro do evento no formato AAAAMMDDThh:m m:ssTZD (UTC \u2013 Universal Coordinated Time).Se o evento for rejeitado informar a data e hora de recebimento do evento. <code>nProt</code> Number N\u00famero do Protocolo do Evento. <code>xml</code> String Retorno original da SEFAZ (XML) convertido para String. <pre><code>[\n  {\n    \"idLote\": \"1\",\n    \"tpAmb\": \"2\",\n    \"verAplic\": \"AN_1.8.4\",\n    \"cOrgao\": \"91\",\n    \"cStat\": \"128\",\n    \"xMotivo\": \"Lote de evento processado\",\n    \"retEvento\": {\n      \"infEvento\": {\n        \"tpAmb\": \"2\",\n        \"verAplic\": \"AN_1.8.4\",\n        \"cOrgao\": \"91\",\n        \"cStat\": \"135\",\n        \"xMotivo\": \"Evento registrado e vinculado a NF-e\",\n        \"chNFe\": \"99999999999999999999999999999999999999999999\",\n        \"tpEvento\": \"210240\",\n        \"xEvento\": \"Operacao nao Realizada\",\n        \"nSeqEvento\": \"1\",\n        \"CNPJDest\": \"99999999999999\",\n        \"dhRegEvento\": \"2024-07-17T17:35:55-03:00\",\n        \"nProt\": \"999999999999999\"\n      }\n    },\n    \"xml\": \"&lt;?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?&gt;&lt;soap:Envelope xmlns:soap=\\\"http://www.w3.org/2003/05/soap-envelope\\\" xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xmlns:xsd=\\\"http://www.w3.org/2001/XMLSchema\\\"&gt;&lt;soap:Body&gt;&lt;nfeRecepcaoEventoNFResult xmlns=\\\"http://www.portalfiscal.inf.br/nfe/wsdl/NFeRecepcaoEvento4\\\"&gt;&lt;retEnvEvento versao=\\\"1.00\\\" xmlns=\\\"http://www.portalfiscal.inf.br/nfe\\\"&gt;&lt;idLote&gt;1&lt;/idLote&gt;&lt;tpAmb&gt;2&lt;/tpAmb&gt;&lt;verAplic&gt;AN_1.8.4&lt;/verAplic&gt;&lt;cOrgao&gt;91&lt;/cOrgao&gt;&lt;cStat&gt;128&lt;/cStat&gt;&lt;xMotivo&gt;Lote de evento processado&lt;/xMotivo&gt;&lt;retEvento versao=\\\"1.00\\\"&gt;&lt;infEvento Id=\\\"ID999999999999999\\\" xmlns=\\\"http://www.portalfiscal.inf.br/nfe\\\"&gt;&lt;tpAmb&gt;2&lt;/tpAmb&gt;&lt;verAplic&gt;AN_1.8.4&lt;/verAplic&gt;&lt;cOrgao&gt;91&lt;/cOrgao&gt;&lt;cStat&gt;135&lt;/cStat&gt;&lt;xMotivo&gt;Evento registrado e vinculado a NF-e&lt;/xMotivo&gt;&lt;chNFe&gt;99999999999999999999999999999999999999999999&lt;/chNFe&gt;&lt;tpEvento&gt;210240&lt;/tpEvento&gt;&lt;xEvento&gt;Operacao nao Realizada&lt;/xEvento&gt;&lt;nSeqEvento&gt;1&lt;/nSeqEvento&gt;&lt;CNPJDest&gt;99999999999999&lt;/CNPJDest&gt;&lt;dhRegEvento&gt;2024-07-17T17:35:55-03:00&lt;/dhRegEvento&gt;&lt;nProt&gt;999999999999999&lt;/nProt&gt;&lt;/infEvento&gt;&lt;/retEvento&gt;&lt;/retEnvEvento&gt;&lt;/nfeRecepcaoEventoNFResult&gt;&lt;/soap:Body&gt;&lt;/soap:Envelope&gt;\"\n  }\n]\n</code></pre> <p></p>"},{"location":"nfeRecepcaoEvento/#nfe_eventopreviodeemissaoemcontingencia","title":"<code>NFE_EventoPrevioDeEmissaoEmContingencia</code>","text":"<p>NFE_EventoPrevioDeEmissaoEmContingencia<pre><code>import { EPEC } from '@Protocols';\n\nconst timeZone = Intl.DateTimeFormat().resolvedOptions().timeZone;\nconst epec: EPEC = {\n    idLote: 1,\n    evento: [\n        {\n            tpAmb: 2,\n            cOrgao: 91,\n            CNPJ: '99999999999999',\n            chNFe: '99999999999999999999999999999999999999999999',\n            dhEvento: format(new Date(), \"yyyy-MM-dd'T'HH:mm:ssXXX\", { timeZone }),\n            tpEvento: '110140',\n            nSeqEvento: 1,\n            verEvento: '1.00',\n            detEvento: {\n                descEvento: 'EPEC',\n                cOrgaoAutor: 35,\n                tpAutor: 1,\n                verAplic: '1.00',\n                dhEmi: '2024-07-10T09:38:55-03:00',\n                tpNF: 1,\n                IE: '999999999999',\n                dest: {\n                    UF: 'SP',\n                    CNPJ: '88888888888888',\n                    IE: '888888888888',\n                    vNF: '999.99',\n                    vICMS: '999.99',\n                    vST: '999.99',\n                }\n            }\n        }\n    ]\n}\n\nawait nfewizard.NFE_EventoPrevioDeEmissaoEmContingencia(epec);\n</code></pre> <code>Retorno</code>:</p> <p> Para mais informa\u00e7\u00f5es sobre o processo consulte <code>Web Service \u2013 NFeRecepcaoEvento \u2013 Parte Geral</code>. </p>"},{"location":"nfeStatusServico/","title":"NFeStatus Servico","text":"<p><code>Fun\u00e7\u00e3o</code>: Servi\u00e7o destinado \u00e0 consulta do status do servi\u00e7o prestado pelo Portal da Secretaria de Fazenda Estadual. <code>Processo</code>: s\u00edncrono. <code>M\u00e9todo</code>: nfeStatusServico</p> <p></p> <p>NFE_ConsultaStatusServico<pre><code>await nfewizard.NFE_ConsultaStatusServico();\n</code></pre> </p> <p><code>Retorno</code>:</p> Interface de Retorno Chave Tipo Descri\u00e7\u00e3o <code>tpAmb</code> Number Identifica\u00e7\u00e3o do Ambiente: 1- Produ\u00e7\u00e3o; 2- Homologa\u00e7\u00e3o <code>verAplic</code> String Vers\u00e3o do Aplicativo que recebeu a Consulta. <code>cStat</code> String C\u00f3digo do status da resposta para o Lote <code>xMotivo</code> String Descri\u00e7\u00e3o literal do status da resposta <code>cUF</code> String C\u00f3digo da UF que atendeu a solicita\u00e7\u00e3o <code>dhRecbto</code> String Preenchido com a data e hora do processamento (informado tamb\u00e9m no caso de rejei\u00e7\u00e3o). Formato: \u201cAAAA-MM-DDThh:m m:ssTZD\u201d (UTC \u2013Universal Coordinated Time). <code>tMed</code> String Tempo m\u00e9dio de resposta do servi\u00e7o (em segundos) dos \u00faltimos 5 minutos (item 5.7). <code>dhRetorno</code> String Preenchido com a data e hora previstas para o retorno do Web Service, no formato \u201cAAAA-MM-DDThh:m m:ss\u201d <code>xml</code> String Retorno original da SEFAZ (XML) convertido para String <pre><code>{\n  \"tpAmb\": \"2\",\n  \"verAplic\": \"SP_NFE_PL009_V4\",\n  \"cStat\": \"107\",\n  \"xMotivo\": \"Servi\u00e7o em Opera\u00e7\u00e3o\",\n  \"cUF\": \"35\",\n  \"dhRecbto\": \"2024-07-16T16:59:59-03:00\",\n  \"tMed\": \"1\",\n  \"xml\": \"&lt;?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?&gt;&lt;soap:Envelope xmlns:soap=\\\"http://www.w3.org/2003/05/soap-envelope\\\" xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xmlns:xsd=\\\"http://www.w3.org/2001/XMLSchema\\\"&gt;&lt;soap:Body&gt;&lt;nfeResultMsg xmlns=\\\"http://www.portalfiscal.inf.br/nfe/wsdl/NFeStatusServico4\\\"&gt;&lt;retConsStatServ versao=\\\"4.00\\\" xmlns=\\\"http://www.portalfiscal.inf.br/nfe\\\"&gt;&lt;tpAmb&gt;2&lt;/tpAmb&gt;&lt;verAplic&gt;SP_NFE_PL009_V4&lt;/verAplic&gt;&lt;cStat&gt;107&lt;/cStat&gt;&lt;xMotivo&gt;Servi\u00e7o em Opera\u00e7\u00e3o&lt;/xMotivo&gt;&lt;cUF&gt;35&lt;/cUF&gt;&lt;dhRecbto&gt;2024-07-16T16:59:59-03:00&lt;/dhRecbto&gt;&lt;tMed&gt;1&lt;/tMed&gt;&lt;/retConsStatServ&gt;&lt;/nfeResultMsg&gt;&lt;/soap:Body&gt;&lt;/soap:Envelope&gt;\"\n}\n</code></pre> <p> Para mais informa\u00e7\u00f5es sobre o processo consulte <code>Web Service \u2013 NfeStatusServico</code>. </p>"},{"location":"nfeUsoIndevido/","title":"Uso Indevido","text":"<p>Uso Indevido</p> <p><code>ATEN\u00c7\u00c3O</code>: O contribuinte que estiver utilizando indevidamente os sistemas poder\u00e1 sofrer as penalidades definidas na legisla\u00e7\u00e3o de cada UF.</p> <p></p> <p>Para mais informa\u00e7\u00f5es sobre o uso indevido consulte os documentos abaixo: <code>Manual de Orienta\u00e7\u00e3o ao Contribuinte da Nota Fiscal Eletr\u00f4nica - 4.3.8</code>. <code>Notas T\u00e9cnicas - Nota T\u00e9cnica 2014.002 - v.1.21 - Publicada em 27/06/2024</code>. <code>Obs: Podem haver vers\u00f5es mais atualizadas para as notas t\u00e9cnicas aqui informadas.</code> </p>"},{"location":"nfeUsoIndevido/#regras-de-uso-indevido-nt-2014002-versoes-121-junho-de-2024","title":"Regras de Uso Indevido - NT 2014.002 - Vers\u00f5es 1.21 \u2013 Junho de 2024","text":""},{"location":"nfeUsoIndevido/#3114-recomendacoes-para-evitar-o-uso-indevido","title":"3.11.4. Recomenda\u00e7\u00f5es Para Evitar o Uso Indevido","text":"<p>A an\u00e1lise do comportamento atual das aplica\u00e7\u00f5es das empresas (\u201caplica\u00e7\u00e3o cliente\u201d) permite identificar algumas situa\u00e7\u00f5es de \u201cuso indevido\u201d nos ambientes autorizadores. Como exemplo maior do mau uso do ambiente, ressalta-se a falta de controle de algumas aplica\u00e7\u00f5es que entram em \u201cloop\u201d, consumindo recursos de forma indevida, sobrecarregando principalmente o canal de comunica\u00e7\u00e3o com a Internet. Para este Web Service ser\u00e3o mantidos controles para identificar as situa\u00e7\u00f5es de uso indevido de sucessivas tentativas de busca de registros j\u00e1 disponibilizados anteriormente, quando utilizada a tag: distNSU. As novas tentativas ser\u00e3o rejeitadas com o erro \u201c656\u2013Rejei\u00e7\u00e3o: Consumo Indevido\u201d.</p>"},{"location":"nfeUsoIndevido/#31141-o-uso-indevido-relativo-ao-web-service-nfedistribuicaodfe-na-consulta-com-tagdistnsu-e-baseado-nos-criterios-descritos-abaixo","title":"3.11.4.1 - O uso indevido relativo ao Web Service NFeDistribuicaoDFe na consulta com tag:distNSU \u00e9 baseado nos crit\u00e9rios descritos abaixo:","text":""},{"location":"nfeUsoIndevido/#1-nao-ha-mais-documentos-a-distribuir-e-usuario-continua-consultando","title":"1) N\u00e3o h\u00e1 mais documentos a distribuir e usu\u00e1rio continua consultando:","text":"<p>Se n\u00e3o existir mais documentos a serem retornados (cStat=137) o usu\u00e1rio deve aguardar uma hora para realizar nova consulta. A realiza\u00e7\u00e3o de novas consultas em 1h, ap\u00f3s receber a mensagem cStat137, gerar\u00e1 o uso indevido, retornando cStat=656. Nesse caso, o CNPJ \u00e9 bloqueado por 1 hora, sendo impedido de realizar novas consultas nesse intervalo. Decorrido o intervalo de tempo, o desbloqueio ser\u00e1 autom\u00e1tico. O campo xMotivo traz a seguinte descri\u00e7\u00e3o para ajudar o usu\u00e1rio a entender o que est\u00e1 causando o uso indevido: \u201cRejeicao: Consumo Indevido. Deve ser aguardado 1 hora para efetuar nova solicita\u00e7\u00e3o caso n\u00e3o existam mais documentos a serem pesquisados. Tente apos 1 hora\u201d</p>"},{"location":"nfeUsoIndevido/#2-usuario-nao-esta-consultando-os-nsu-de-forma-sequencial","title":"2) Usu\u00e1rio n\u00e3o est\u00e1 consultando os NSU de forma sequencial:","text":"<p>O usu\u00e1rio deve sempre realizar a consulta baseada no ultNsu retornado na consulta anterior, ou seja, deve usar os valores do ultNSU retornados pelo servi\u00e7o nas chamadas subsequentes. O valor do ultNSU corresponde ao ponto de onde a leitura dos blocos de documentos deve continuar. Quando ultNSU for igual ao valor do maxNSU retornado pelo servi\u00e7o, quer dizer que n\u00e3o existem mais documentos para serem recuperados. Neste caso, para n\u00e3o haver bloqueio por uso indevido, deve-se aguardar 1 hora para realiza\u00e7\u00e3o de novas consultas. Se consultar fora da sequ\u00eancia, ser\u00e1 bloqueado. Decorrido o intervalo de tempo, o desbloqueio ser\u00e1 autom\u00e1tico.</p> <p>O campo xMotivo traz a seguinte mensagem: \u201cRejeicao: Consumo Indevido. Deve ser utilizado o ultNSU nas solicitacoes subsequentes. Tente apos 1 hora\u201d</p> <p><code>Aten\u00e7\u00e3o</code>: Se diversas aplica\u00e7\u00f5es do mesmo ator (emitente ou destinat\u00e1rio ou transportador na NF-e ou indicado no campo autxml) da NF-e efetuarem consultas por NSU para o mesmo CNPJ (14 d\u00edgitos \u2013 informado na requisi\u00e7\u00e3o xml), essas devem seguir a mesma sequ\u00eancia de numera\u00e7\u00e3o ordenada e de forma ascendente. Caso contr\u00e1rio, enquadrar-se\u00e3o na categoria de uso indevido.</p> <p><code>Observa\u00e7\u00e3o</code>: A partir da data informada na vers\u00e3o 1.14 desta Nota T\u00e9cnica, o n\u00famero da \u00faltima consulta realizada para o CNPJ de 14 d\u00edgitos informado na requisi\u00e7\u00e3o passou a ser retornado no XML da rejei\u00e7\u00e3o 656 (consumo indevido), caso a consulta tenha sido efetuada com a tag \u201cdistNSU\u201d. Assim, caso o usu\u00e1rio n\u00e3o conhe\u00e7a o n\u00famero do ultNSU, pode realizar a consulta a partir deste n\u00famero.</p>"},{"location":"nfeUsoIndevido/#31142-o-uso-indevido-relativo-ao-web-service-nfedistribuicaodfe-nas-consultas-com-tag-conschnfe-e-tag-consnsu","title":"3.11.4.2 - O uso indevido relativo ao Web Service NFeDistribuicaoDFe nas consultas com tag: consChNFe e tag: consNSU:","text":"<p>As consultas por chave de acesso e por NSU foram constru\u00eddas para permitirem ao usu\u00e1rio buscar pontualmente alguma NF-e e de um per\u00edodo retroativo m\u00e1ximo de 90 (noventa) dias. Se o usu\u00e1rio necessitar fazer download de todas as NF-es de no m\u00e1ximo 90 dias de um CNPJ ator interessado, deve usar a consulta \u201cdistNSU\u201d.</p>"},{"location":"nfeUsoIndevido/#1-consultada-uma-quantidade-de-nf-e-ou-nsu-superior-ao-limite-permitido-por-hora","title":"1) Consultada uma quantidade de NF-e ou NSU superior ao limite permitido por hora:","text":"<p>Ser\u00e1 permitido um n\u00famero limitado de consultas por chave de acesso ou NSU em um per\u00edodo de 1hora. Se o usu\u00e1rio continuar consultando ap\u00f3s atingir o limite de consultas por chave de acesso ou NSU em 1h, retornar\u00e1 a mensagem 656 \u2013 Consumo indevido \u2013 ultrapassou o limite de 20 consultas por hora. Nesse caso, o CNPJ \u00e9 bloqueado por 1 hora, sendo impedido de realizar novas consultas nesse intervalo. Decorrido o intervalo de tempo, o desbloqueio ser\u00e1 autom\u00e1tico. Observa\u00e7\u00e3o: Em quaisquer dos tr\u00eas tipos de consulta, quando o usu\u00e1rio receber a mensagem 656 \u2013 consumo indevido, deve aguardar 1hora. Se retomar a consulta antes de completar 1 (uma) hora, o tempo \u00e9 zerado e a contagem reiniciar\u00e1 at\u00e9 completar 1hora.</p>"}]}